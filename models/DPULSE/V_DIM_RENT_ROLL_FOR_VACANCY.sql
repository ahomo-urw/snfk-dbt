create or replace view EXPOSE_DEV.DPERFMGT.V_DIM_RENT_ROLL_FOR_VACANCY(
	SCENARIOS_RR,
	KEY_R,
	PC_ID,
	BU_EXTREF,
	PRODUCT_EXT_REF,
	CONTRACT_ID,
	CUTOFFCALMONTH,
	IS_VALIDATED,
	SOURCEOFLEASERS,
	STATUS,
	CONSOPCT,
	OLD_CTENANT,
	CTENANT,
	COPERAT,
	COPETYPE,
	OCCUPANCYSTARTDATE,
	OCCUPANCYENDDATE,
	CUSAGETYP,
	CONTRSTART,
	TERMDATE,
	CDNXBKOP,
	PREVREVDATE,
	NEXTREVDATE,
	CURRIDXTYPE,
	PERIODREF,
	VACTYPE,
	COMMENTS,
	RSSTRUCTSTATUS,
	RSORIGIN,
	POTTRANS,
	AREACHGEL,
	GLAUNIT,
	KGLA,
	TERMDURATION,
	FIRMTERMDURATION,
	CURRINDEXVAL,
	COUNTED,
	NEXT_OPE
) comment= 'SGE202506: quote relevant en fonction du step reporting *PBI'
as
select
scenarios_rr,
key_r,
dim.cpropc PC_ID,
replace(rebuild,'-','/') BU_EXTREF,
replace ( dim.crentspac ,'#','-') PRODUCT_EXT_REF,
--clease,
clease1_text Contract_ID,
	CUTOFFCALMONTH,
	IS_VALIDATED,
	SOURCEOFLEASERS,
	STATUS,
	CONSOPCT,
	OLD_CTENANT,
	CTENANT,
	dim.COPERAT,
	COPETYPE,
	OCCUPANCYSTARTDATE,
	OCCUPANCYENDDATE,
	dim.CUSAGETYP,
	CONTRSTART,
	TERMDATE,
	CDNXBKOP,
	PREVREVDATE,
	NEXTREVDATE,
	CURRIDXTYPE,
	PERIODREF,
	VACTYPE,
	COMMENTS,
	RSSTRUCTSTATUS,
	RSORIGIN,
	POTTRANS,
	AREACHGEL,
	GLAUNIT,
	KGLA,
	TERMDURATION,
	FIRMTERMDURATION,
	CURRINDEXVAL,
	COUNTED,
	NEXT_OPE  
from EXPOSE.DPERFMGT.PLANIT_OPERATION_DIM_RENT_ROLL_FOR_VACANCY_AGG dim 
 join  expose.cpulse.planit_transverse_table_refresh_scope  scope 
    on dim.cscenario=scope.cscenario 
    and dim.cversion=scope.cversion
    and service='WORKLOAD'
    and dim.cutoffcalmonth = to_char(to_date(datefrom,'YYYYMMDD'),'YYYYMM')
    and is_validated='X'
;