[0m13:01:48.782476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D57AE33620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D57BB2E490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D57C057ED0>]}


============================== 13:01:48.787287 | beb86b12-b343-44f6-9351-c82dba562ee7 ==============================
[0m13:01:48.787287 [info ] [MainThread]: Running with dbt=1.10.1
[0m13:01:48.788027 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alban.homo\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'c:\\Users\\alban.homo\\dev\\DPERFMGT\\GLOBAL_PERFMGT\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:01:48.894073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'beb86b12-b343-44f6-9351-c82dba562ee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D57B52AD70>]}
[0m13:01:48.914099 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:01:48.916195 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:01:48.917061 [debug] [MainThread]: Command `cli deps` succeeded at 13:01:48.916947 after 0.42 seconds
[0m13:01:48.917407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D57BF69D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D57BF69040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D57BF45C50>]}
[0m13:01:48.917726 [debug] [MainThread]: Flushing usage events
[0m13:01:49.372070 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:11:05.395187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FC00BF620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FC0DBE490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FC12E7ED0>]}


============================== 13:11:05.403784 | f283d355-c27a-4402-87c6-008682ac4f7e ==============================
[0m13:11:05.403784 [info ] [MainThread]: Running with dbt=1.10.1
[0m13:11:05.405210 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\alban.homo\\.dbt', 'log_path': 'c:\\Users\\alban.homo\\dev\\DPERFMGT\\GLOBAL_PERFMGT\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:11:05.508143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f283d355-c27a-4402-87c6-008682ac4f7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FC07B6D70>]}
[0m13:11:05.527995 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:11:05.530745 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:11:05.531577 [debug] [MainThread]: Command `cli deps` succeeded at 13:11:05.531446 after 0.42 seconds
[0m13:11:05.532237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FC11FDD00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FC11FD040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FC11D5C50>]}
[0m13:11:05.532543 [debug] [MainThread]: Flushing usage events
[0m13:11:05.866103 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:58:05.229631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163D04BF620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163D11CE490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163D16F7ED0>]}


============================== 13:58:05.234215 | 3f60a4ac-c592-426a-bc0f-7ceaadbff118 ==============================
[0m13:58:05.234215 [info ] [MainThread]: Running with dbt=1.10.1
[0m13:58:05.235063 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'c:\\Users\\alban.homo\\dev\\dperfmgt\\GLOBAL_PERFMGT\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\alban.homo\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt ', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:58:05.331226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f60a4ac-c592-426a-bc0f-7ceaadbff118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163D0BCAD70>]}
[0m13:58:05.349300 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:58:05.351550 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:58:05.352617 [debug] [MainThread]: Command `cli deps` succeeded at 13:58:05.352468 after 0.37 seconds
[0m13:58:05.352956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163D160DD00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163D160D040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163D15E5C50>]}
[0m13:58:05.353249 [debug] [MainThread]: Flushing usage events
[0m13:58:05.661043 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:00:29.574199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015820B93770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158218A6490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015821DCFD90>]}


============================== 14:00:29.578457 | dd82e797-3d62-4969-be4b-a2ac0c0435e8 ==============================
[0m14:00:29.578457 [info ] [MainThread]: Running with dbt=1.10.1
[0m14:00:29.579689 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\alban.homo\\.dbt', 'log_path': 'C:\\Users\\alban.homo\\dev\\dperfmgt\\global_perfmgt\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select run my_first_dbt_model', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:00:29.930381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd82e797-3d62-4969-be4b-a2ac0c0435e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158212AEFD0>]}
[0m14:00:29.970974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd82e797-3d62-4969-be4b-a2ac0c0435e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015823D558C0>]}
[0m14:00:29.971945 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m14:00:30.151480 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m14:00:30.312328 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:00:30.312643 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:00:30.335337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd82e797-3d62-4969-be4b-a2ac0c0435e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015823F2C850>]}
[0m14:00:30.378807 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\manifest.json
[0m14:00:30.386608 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\semantic_manifest.json
[0m14:00:30.406292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd82e797-3d62-4969-be4b-a2ac0c0435e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015820B9BA70>]}
[0m14:00:30.406745 [info ] [MainThread]: Found 2 models, 4 data tests, 476 macros
[0m14:00:30.407928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd82e797-3d62-4969-be4b-a2ac0c0435e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015823DFC9F0>]}
[0m14:00:30.408598 [warn ] [MainThread]: The selection criterion 'run' does not match any enabled nodes
[0m14:00:30.409882 [info ] [MainThread]: 
[0m14:00:30.410343 [info ] [MainThread]: Concurrency: 200 threads (target='dev')
[0m14:00:30.410698 [info ] [MainThread]: 
[0m14:00:30.411082 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:00:30.412256 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_expose_dev'
[0m14:00:30.544720 [debug] [ThreadPool]: Using snowflake connection "list_expose_dev"
[0m14:00:30.545036 [debug] [ThreadPool]: On list_expose_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "connection_name": "list_expose_dev"} */
show terse schemas in database expose_dev
    limit 10000
[0m14:00:30.545237 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:00:36.358675 [debug] [ThreadPool]: SQL status: SUCCESS 54 in 5.813 seconds
[0m14:00:36.376076 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_expose_dev_dpulse'
[0m14:00:36.389145 [debug] [ThreadPool]: Using snowflake connection "list_expose_dev_dpulse"
[0m14:00:36.389640 [debug] [ThreadPool]: On list_expose_dev_dpulse: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "connection_name": "list_expose_dev_dpulse"} */
alter session set quoted_identifiers_ignore_case = false;
[0m14:00:36.390117 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:00:36.769127 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.379 seconds
[0m14:00:36.775657 [debug] [ThreadPool]: Using snowflake connection "list_expose_dev_dpulse"
[0m14:00:36.776359 [debug] [ThreadPool]: On list_expose_dev_dpulse: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "connection_name": "list_expose_dev_dpulse"} */
show objects in expose_dev.dpulse
    limit 10000
    
;
[0m14:00:37.247957 [debug] [ThreadPool]: SQL status: SUCCESS 95 in 0.471 seconds
[0m14:00:37.256197 [debug] [ThreadPool]: Using snowflake connection "list_expose_dev_dpulse"
[0m14:00:37.256704 [debug] [ThreadPool]: On list_expose_dev_dpulse: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "connection_name": "list_expose_dev_dpulse"} */
alter session unset quoted_identifiers_ignore_case;
[0m14:00:37.613660 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.356 seconds
[0m14:00:37.644724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd82e797-3d62-4969-be4b-a2ac0c0435e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158248F1F30>]}
[0m14:00:37.758192 [debug] [Thread-1 (]: Began running node model.GLOBAL_PERFMGT.my_first_dbt_model
[0m14:00:37.759101 [info ] [Thread-1 (]: 1 of 1 START sql table model dpulse.my_first_dbt_model ......................... [RUN]
[0m14:00:37.760101 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.GLOBAL_PERFMGT.my_first_dbt_model'
[0m14:00:37.760348 [debug] [Thread-1 (]: Began compiling node model.GLOBAL_PERFMGT.my_first_dbt_model
[0m14:00:37.764988 [debug] [Thread-1 (]: Writing injected SQL for node "model.GLOBAL_PERFMGT.my_first_dbt_model"
[0m14:00:37.771304 [debug] [Thread-1 (]: Began executing node model.GLOBAL_PERFMGT.my_first_dbt_model
[0m14:00:37.827075 [debug] [Thread-1 (]: Writing runtime sql for node "model.GLOBAL_PERFMGT.my_first_dbt_model"
[0m14:00:37.833254 [debug] [Thread-1 (]: Using snowflake connection "model.GLOBAL_PERFMGT.my_first_dbt_model"
[0m14:00:37.834334 [debug] [Thread-1 (]: On model.GLOBAL_PERFMGT.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "node_id": "model.GLOBAL_PERFMGT.my_first_dbt_model"} */
create or replace transient table expose_dev.dpulse.my_first_dbt_model
    

    
    as (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
;
[0m14:00:37.835322 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:00:38.974564 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.139 seconds
[0m14:00:39.004981 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd82e797-3d62-4969-be4b-a2ac0c0435e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015824B8AB10>]}
[0m14:00:39.006186 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dpulse.my_first_dbt_model .................... [[32mSUCCESS 1[0m in 1.24s]
[0m14:00:39.007387 [debug] [Thread-1 (]: Finished running node model.GLOBAL_PERFMGT.my_first_dbt_model
[0m14:00:39.019104 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:00:39.019510 [debug] [MainThread]: Connection 'list_expose_dev' was left open.
[0m14:00:39.019771 [debug] [MainThread]: On list_expose_dev: Close
[0m14:00:39.102855 [debug] [MainThread]: Connection 'list_expose_dev_dpulse' was left open.
[0m14:00:39.103721 [debug] [MainThread]: On list_expose_dev_dpulse: Close
[0m14:00:39.662028 [debug] [MainThread]: Connection 'model.GLOBAL_PERFMGT.my_first_dbt_model' was left open.
[0m14:00:39.663000 [debug] [MainThread]: On model.GLOBAL_PERFMGT.my_first_dbt_model: Close
[0m14:00:39.874456 [info ] [MainThread]: 
[0m14:00:39.875775 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.46 seconds (9.46s).
[0m14:00:39.878099 [debug] [MainThread]: Command end result
[0m14:00:39.906932 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\manifest.json
[0m14:00:39.910890 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\semantic_manifest.json
[0m14:00:39.916657 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\run_results.json
[0m14:00:39.917170 [info ] [MainThread]: 
[0m14:00:39.917922 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:00:39.918434 [info ] [MainThread]: 
[0m14:00:39.919125 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:00:39.920084 [debug] [MainThread]: Command `dbt run` succeeded at 14:00:39.919995 after 10.59 seconds
[0m14:00:39.920357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158248BBD80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158248AC730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158248ACC30>]}
[0m14:00:39.920600 [debug] [MainThread]: Flushing usage events
[0m14:00:39.983218 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:35:32.267955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214542D3770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021454FE6490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002145550FD90>]}


============================== 15:35:32.276362 | 4c73f3f7-bf42-4bd6-baea-60c973393bbe ==============================
[0m15:35:32.276362 [info ] [MainThread]: Running with dbt=1.10.1
[0m15:35:32.277109 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\alban.homo\\dev\\dperfmgt\\global_perfmgt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\alban.homo\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select select_crm.sql', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:35:32.796232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c73f3f7-bf42-4bd6-baea-60c973393bbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214549EAFD0>]}
[0m15:35:32.836899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c73f3f7-bf42-4bd6-baea-60c973393bbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214574258C0>]}
[0m15:35:32.838180 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m15:35:33.061697 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m15:35:33.227483 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m15:35:33.227943 [debug] [MainThread]: Partial parsing: added file: GLOBAL_PERFMGT://models\select_crm.sql
[0m15:35:33.388008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c73f3f7-bf42-4bd6-baea-60c973393bbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214578C1150>]}
[0m15:35:33.430407 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\manifest.json
[0m15:35:33.438606 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\semantic_manifest.json
[0m15:35:33.479208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c73f3f7-bf42-4bd6-baea-60c973393bbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214542DBA70>]}
[0m15:35:33.479651 [info ] [MainThread]: Found 4 models, 4 data tests, 476 macros
[0m15:35:33.480154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c73f3f7-bf42-4bd6-baea-60c973393bbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214574CE6D0>]}
[0m15:35:33.481871 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:35:33.482489 [debug] [MainThread]: Command end result
[0m15:35:33.499738 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\manifest.json
[0m15:35:33.502265 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\semantic_manifest.json
[0m15:35:33.506110 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\run_results.json
[0m15:35:33.507265 [debug] [MainThread]: Command `dbt run` succeeded at 15:35:33.507125 after 1.54 seconds
[0m15:35:33.507602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021457A0BEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021455243F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021457A21310>]}
[0m15:35:33.507886 [debug] [MainThread]: Flushing usage events
[0m15:35:34.112255 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:37:31.306440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B3CAF3770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B3D7F6490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B3DD1FD90>]}


============================== 15:37:31.309831 | 1f67f6d9-063a-4618-bfa3-e320ff32b79b ==============================
[0m15:37:31.309831 [info ] [MainThread]: Running with dbt=1.10.1
[0m15:37:31.310786 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\alban.homo\\.dbt', 'log_path': 'C:\\Users\\alban.homo\\dev\\dperfmgt\\global_perfmgt\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select select_crm.sql', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:37:31.668499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f67f6d9-063a-4618-bfa3-e320ff32b79b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B3D1FEFD0>]}
[0m15:37:31.707878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f67f6d9-063a-4618-bfa3-e320ff32b79b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B3FC358C0>]}
[0m15:37:31.708838 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m15:37:31.873795 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m15:37:32.037378 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:37:32.037688 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:37:32.060911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f67f6d9-063a-4618-bfa3-e320ff32b79b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B400CC850>]}
[0m15:37:32.104185 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\manifest.json
[0m15:37:32.108292 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\semantic_manifest.json
[0m15:37:32.126021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f67f6d9-063a-4618-bfa3-e320ff32b79b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B3CAFBA70>]}
[0m15:37:32.126460 [info ] [MainThread]: Found 4 models, 4 data tests, 476 macros
[0m15:37:32.127121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f67f6d9-063a-4618-bfa3-e320ff32b79b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B3FCDD8D0>]}
[0m15:37:32.128271 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:37:32.129865 [debug] [MainThread]: Command end result
[0m15:37:32.147266 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\manifest.json
[0m15:37:32.149668 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\semantic_manifest.json
[0m15:37:32.153605 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\run_results.json
[0m15:37:32.154326 [debug] [MainThread]: Command `dbt run` succeeded at 15:37:32.154220 after 1.10 seconds
[0m15:37:32.154619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B40106DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B3DA53F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B40118950>]}
[0m15:37:32.154885 [debug] [MainThread]: Flushing usage events
[0m15:37:32.495781 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:44:40.157268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021521433770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021522136490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002152265FD90>]}


============================== 15:44:40.162845 | b45a6467-53ec-45d7-96ed-5c134484a1ce ==============================
[0m15:44:40.162845 [info ] [MainThread]: Running with dbt=1.10.1
[0m15:44:40.164081 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alban.homo\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\alban.homo\\dev\\dperfmgt\\global_perfmgt\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select crm_deal_quote_relevant', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:44:40.512262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b45a6467-53ec-45d7-96ed-5c134484a1ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021521B3EFD0>]}
[0m15:44:40.555333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b45a6467-53ec-45d7-96ed-5c134484a1ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215246658C0>]}
[0m15:44:40.556360 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m15:44:40.771094 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m15:44:40.927901 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:44:40.928263 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:44:40.952786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b45a6467-53ec-45d7-96ed-5c134484a1ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021524AFCD50>]}
[0m15:44:40.995649 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\manifest.json
[0m15:44:40.999547 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\semantic_manifest.json
[0m15:44:41.019324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b45a6467-53ec-45d7-96ed-5c134484a1ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002152143BA70>]}
[0m15:44:41.019779 [info ] [MainThread]: Found 4 models, 6 data tests, 476 macros
[0m15:44:41.020197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b45a6467-53ec-45d7-96ed-5c134484a1ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002152470C9F0>]}
[0m15:44:41.021341 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:44:41.022964 [debug] [MainThread]: Command end result
[0m15:44:41.043336 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\manifest.json
[0m15:44:41.046659 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\semantic_manifest.json
[0m15:44:41.051570 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\run_results.json
[0m15:44:41.052784 [debug] [MainThread]: Command `dbt run` succeeded at 15:44:41.052597 after 1.21 seconds
[0m15:44:41.053211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021524BB3EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021522393F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021524B58A10>]}
[0m15:44:41.053621 [debug] [MainThread]: Flushing usage events
[0m15:44:41.454726 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:45:03.477581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B469893770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B46A596490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B46AABFD90>]}


============================== 15:45:03.484957 | 218adf31-3d37-422e-a0ab-dc72a8a2cab8 ==============================
[0m15:45:03.484957 [info ] [MainThread]: Running with dbt=1.10.1
[0m15:45:03.486554 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alban.homo\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\alban.homo\\dev\\dperfmgt\\global_perfmgt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:45:03.839436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '218adf31-3d37-422e-a0ab-dc72a8a2cab8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B469F9EFD0>]}
[0m15:45:03.880656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '218adf31-3d37-422e-a0ab-dc72a8a2cab8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B46CA258C0>]}
[0m15:45:03.881632 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m15:45:04.049455 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m15:45:04.214992 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:45:04.215314 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:45:04.238876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '218adf31-3d37-422e-a0ab-dc72a8a2cab8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B46CEBCD50>]}
[0m15:45:04.284606 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\manifest.json
[0m15:45:04.288381 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\semantic_manifest.json
[0m15:45:04.307022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '218adf31-3d37-422e-a0ab-dc72a8a2cab8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B46989BA70>]}
[0m15:45:04.307439 [info ] [MainThread]: Found 4 models, 6 data tests, 476 macros
[0m15:45:04.307992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '218adf31-3d37-422e-a0ab-dc72a8a2cab8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B46CACC9F0>]}
[0m15:45:04.309292 [info ] [MainThread]: 
[0m15:45:04.310004 [info ] [MainThread]: Concurrency: 200 threads (target='dev')
[0m15:45:04.310464 [info ] [MainThread]: 
[0m15:45:04.310994 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:45:04.314346 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_expose_dev'
[0m15:45:04.439238 [debug] [ThreadPool]: Using snowflake connection "list_expose_dev"
[0m15:45:04.439600 [debug] [ThreadPool]: On list_expose_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "connection_name": "list_expose_dev"} */
show terse schemas in database expose_dev
    limit 10000
[0m15:45:04.439843 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:45:05.524650 [debug] [ThreadPool]: SQL status: SUCCESS 54 in 1.085 seconds
[0m15:45:05.534840 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_expose_dev_dpulse'
[0m15:45:05.544899 [debug] [ThreadPool]: Using snowflake connection "list_expose_dev_dpulse"
[0m15:45:05.545259 [debug] [ThreadPool]: On list_expose_dev_dpulse: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "connection_name": "list_expose_dev_dpulse"} */
alter session set quoted_identifiers_ignore_case = false;
[0m15:45:05.545450 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:45:06.091975 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.546 seconds
[0m15:45:06.098686 [debug] [ThreadPool]: Using snowflake connection "list_expose_dev_dpulse"
[0m15:45:06.099349 [debug] [ThreadPool]: On list_expose_dev_dpulse: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "connection_name": "list_expose_dev_dpulse"} */
show objects in expose_dev.dpulse
    limit 10000
    
;
[0m15:45:06.425132 [debug] [ThreadPool]: SQL status: SUCCESS 96 in 0.325 seconds
[0m15:45:06.431484 [debug] [ThreadPool]: Using snowflake connection "list_expose_dev_dpulse"
[0m15:45:06.432207 [debug] [ThreadPool]: On list_expose_dev_dpulse: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "connection_name": "list_expose_dev_dpulse"} */
alter session unset quoted_identifiers_ignore_case;
[0m15:45:06.623830 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.191 seconds
[0m15:45:06.645179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '218adf31-3d37-422e-a0ab-dc72a8a2cab8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B46D3E5D90>]}
[0m15:45:06.683908 [debug] [Thread-1 (]: Began running node model.GLOBAL_PERFMGT.my_first_dbt_model
[0m15:45:06.684458 [info ] [Thread-1 (]: 1 of 2 START sql table model dpulse.my_first_dbt_model ......................... [RUN]
[0m15:45:06.685234 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.GLOBAL_PERFMGT.my_first_dbt_model'
[0m15:45:06.685522 [debug] [Thread-1 (]: Began compiling node model.GLOBAL_PERFMGT.my_first_dbt_model
[0m15:45:06.689819 [debug] [Thread-1 (]: Writing injected SQL for node "model.GLOBAL_PERFMGT.my_first_dbt_model"
[0m15:45:06.691499 [debug] [Thread-1 (]: Began executing node model.GLOBAL_PERFMGT.my_first_dbt_model
[0m15:45:06.714478 [debug] [Thread-1 (]: Writing runtime sql for node "model.GLOBAL_PERFMGT.my_first_dbt_model"
[0m15:45:06.717271 [debug] [Thread-1 (]: Using snowflake connection "model.GLOBAL_PERFMGT.my_first_dbt_model"
[0m15:45:06.717628 [debug] [Thread-1 (]: On model.GLOBAL_PERFMGT.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "node_id": "model.GLOBAL_PERFMGT.my_first_dbt_model"} */
create or replace transient table expose_dev.dpulse.my_first_dbt_model
    

    
    as (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
;
[0m15:45:06.717866 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:45:08.394003 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.676 seconds
[0m15:45:08.417504 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '218adf31-3d37-422e-a0ab-dc72a8a2cab8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B46D655010>]}
[0m15:45:08.418055 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dpulse.my_first_dbt_model .................... [[32mSUCCESS 1[0m in 1.73s]
[0m15:45:08.418813 [debug] [Thread-1 (]: Finished running node model.GLOBAL_PERFMGT.my_first_dbt_model
[0m15:45:08.419400 [debug] [Thread-2 (]: Began running node model.GLOBAL_PERFMGT.my_second_dbt_model
[0m15:45:08.419896 [info ] [Thread-2 (]: 2 of 2 START sql view model dpulse.my_second_dbt_model ......................... [RUN]
[0m15:45:08.420478 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.GLOBAL_PERFMGT.my_second_dbt_model'
[0m15:45:08.420763 [debug] [Thread-2 (]: Began compiling node model.GLOBAL_PERFMGT.my_second_dbt_model
[0m15:45:08.424739 [debug] [Thread-2 (]: Writing injected SQL for node "model.GLOBAL_PERFMGT.my_second_dbt_model"
[0m15:45:08.426560 [debug] [Thread-2 (]: Began executing node model.GLOBAL_PERFMGT.my_second_dbt_model
[0m15:45:08.443214 [debug] [Thread-2 (]: Writing runtime sql for node "model.GLOBAL_PERFMGT.my_second_dbt_model"
[0m15:45:08.445352 [debug] [Thread-2 (]: Using snowflake connection "model.GLOBAL_PERFMGT.my_second_dbt_model"
[0m15:45:08.445694 [debug] [Thread-2 (]: On model.GLOBAL_PERFMGT.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "node_id": "model.GLOBAL_PERFMGT.my_second_dbt_model"} */
create or replace   view expose_dev.dpulse.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from expose_dev.dpulse.my_first_dbt_model
where id = 1
  );
[0m15:45:08.445944 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:45:09.179022 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.733 seconds
[0m15:45:09.183474 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '218adf31-3d37-422e-a0ab-dc72a8a2cab8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B46D5735F0>]}
[0m15:45:09.184839 [info ] [Thread-2 (]: 2 of 2 OK created sql view model dpulse.my_second_dbt_model .................... [[32mSUCCESS 1[0m in 0.76s]
[0m15:45:09.186851 [debug] [Thread-2 (]: Finished running node model.GLOBAL_PERFMGT.my_second_dbt_model
[0m15:45:09.207116 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:45:09.207461 [debug] [MainThread]: Connection 'list_expose_dev' was left open.
[0m15:45:09.207677 [debug] [MainThread]: On list_expose_dev: Close
[0m15:45:09.392116 [debug] [MainThread]: Connection 'list_expose_dev_dpulse' was left open.
[0m15:45:09.393085 [debug] [MainThread]: On list_expose_dev_dpulse: Close
[0m15:45:09.596459 [debug] [MainThread]: Connection 'model.GLOBAL_PERFMGT.my_first_dbt_model' was left open.
[0m15:45:09.597356 [debug] [MainThread]: On model.GLOBAL_PERFMGT.my_first_dbt_model: Close
[0m15:45:09.843116 [debug] [MainThread]: Connection 'model.GLOBAL_PERFMGT.my_second_dbt_model' was left open.
[0m15:45:09.844031 [debug] [MainThread]: On model.GLOBAL_PERFMGT.my_second_dbt_model: Close
[0m15:45:10.048346 [info ] [MainThread]: 
[0m15:45:10.049549 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 5.74 seconds (5.74s).
[0m15:45:10.051544 [debug] [MainThread]: Command end result
[0m15:45:10.073116 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\manifest.json
[0m15:45:10.076378 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\semantic_manifest.json
[0m15:45:10.082419 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\run_results.json
[0m15:45:10.082785 [info ] [MainThread]: 
[0m15:45:10.083579 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:45:10.084206 [info ] [MainThread]: 
[0m15:45:10.084798 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m15:45:10.085558 [debug] [MainThread]: Command `dbt run` succeeded at 15:45:10.085461 after 6.84 seconds
[0m15:45:10.085851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B46D80E530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B46D56C680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B46D18A950>]}
[0m15:45:10.086120 [debug] [MainThread]: Flushing usage events
[0m15:45:10.189537 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:47:33.265850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225CB523770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225CC226490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225CC74FD90>]}


============================== 15:47:33.269730 | 53fadac0-b4b1-4592-9daa-c95748f21daf ==============================
[0m15:47:33.269730 [info ] [MainThread]: Running with dbt=1.10.1
[0m15:47:33.270621 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alban.homo\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\alban.homo\\dev\\dperfmgt\\global_perfmgt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:47:33.616666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53fadac0-b4b1-4592-9daa-c95748f21daf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225CBC2EFD0>]}
[0m15:47:33.656127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '53fadac0-b4b1-4592-9daa-c95748f21daf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225CE6158C0>]}
[0m15:47:33.657139 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m15:47:33.824292 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m15:47:33.991028 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 3 files added, 0 files changed.
[0m15:47:33.991519 [debug] [MainThread]: Partial parsing: added file: GLOBAL_PERFMGT://models\transform\schema.yml
[0m15:47:33.991768 [debug] [MainThread]: Partial parsing: added file: GLOBAL_PERFMGT://models\transform\select_crm.sql
[0m15:47:33.991988 [debug] [MainThread]: Partial parsing: added file: GLOBAL_PERFMGT://models\transform\crm_deal_quote_relevant.sql
[0m15:47:33.992196 [debug] [MainThread]: Partial parsing: deleted file: GLOBAL_PERFMGT://models\select_crm.sql
[0m15:47:33.992361 [debug] [MainThread]: Partial parsing: deleted file: GLOBAL_PERFMGT://models\example\crm_deal_quote_relevant.sql
[0m15:47:34.158988 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'CRM_DEAL_QUOTE_RELEVANT' in the 'models' section of file 'models\transform\schema.yml'
[0m15:47:34.161544 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two schema.yml entries for the same resource named my_first_dbt_model. Resources and their associated columns may only be described a single time. To fix this, remove the resource entry for my_first_dbt_model in one of these files:
   - models\transform\schema.yml
  models\example\schema.yml
[0m15:47:34.162688 [debug] [MainThread]: Command `dbt run` failed at 15:47:34.162589 after 1.15 seconds
[0m15:47:34.162959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225CEAAD650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225CEAAD750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225CEB65040>]}
[0m15:47:34.163225 [debug] [MainThread]: Flushing usage events
[0m15:47:34.514150 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:52:05.344259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBA2653770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBA3366490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBA388FD90>]}


============================== 15:52:05.347658 | 062617bc-3627-4112-afd9-a917c03d0d35 ==============================
[0m15:52:05.347658 [info ] [MainThread]: Running with dbt=1.10.1
[0m15:52:05.348489 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alban.homo\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\alban.homo\\dev\\dperfmgt\\global_perfmgt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select crm_deal_quote_relevant', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:52:05.715435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '062617bc-3627-4112-afd9-a917c03d0d35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBA2D6EFD0>]}
[0m15:52:05.760166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '062617bc-3627-4112-afd9-a917c03d0d35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBA57C58C0>]}
[0m15:52:05.761209 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m15:52:05.945112 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m15:52:06.069034 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:52:06.069611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '062617bc-3627-4112-afd9-a917c03d0d35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBA5776350>]}
[0m15:52:06.678011 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'CRM_DEAL_QUOTE_RELEVANT' in the 'models' section of file 'models\example\schema.yml'
[0m15:52:06.748868 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'CRM_DEAL_QUOTE_RELEVANT' in the 'models' section of file 'models\transform\schema.yml'
[0m15:52:06.749954 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two schema.yml entries for the same resource named select_crm. Resources and their associated columns may only be described a single time. To fix this, remove the resource entry for select_crm in one of these files:
   - models\transform\schema.yml
  models\example\schema.yml
[0m15:52:06.751860 [debug] [MainThread]: Command `dbt run` failed at 15:52:06.751689 after 1.67 seconds
[0m15:52:06.752227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBA5B73F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBA5E58050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBA379BE70>]}
[0m15:52:06.752571 [debug] [MainThread]: Flushing usage events
[0m15:52:07.115522 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:56:11.374181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206E4B23770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206E5836490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206E5D5FD90>]}


============================== 15:56:11.381621 | 7fa2a8c6-c263-4e57-b3ae-58605fb28a5d ==============================
[0m15:56:11.381621 [info ] [MainThread]: Running with dbt=1.10.1
[0m15:56:11.382484 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alban.homo\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\alban.homo\\dev\\dperfmgt\\global_perfmgt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select crm_deal_quote_relevant', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:56:11.720226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7fa2a8c6-c263-4e57-b3ae-58605fb28a5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206E523EFD0>]}
[0m15:56:11.760747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7fa2a8c6-c263-4e57-b3ae-58605fb28a5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206E7C758C0>]}
[0m15:56:11.761755 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m15:56:11.934850 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m15:56:12.040885 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:56:12.041501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7fa2a8c6-c263-4e57-b3ae-58605fb28a5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206E7C2A350>]}
[0m15:56:12.629152 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'CRM_DEAL_QUOTE_RELEVANT' in the 'models' section of file 'models\example\schema.yml'
[0m15:56:12.696395 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'CRM_DEAL_QUOTE_RELEVANT' in the 'models' section of file 'models\transform\schema.yml'
[0m15:56:12.697331 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two schema.yml entries for the same resource named select_crm. Resources and their associated columns may only be described a single time. To fix this, remove the resource entry for select_crm in one of these files:
   - models\transform\schema.yml
  models\example\schema.yml
[0m15:56:12.698801 [debug] [MainThread]: Command `dbt run` failed at 15:56:12.698702 after 1.58 seconds
[0m15:56:12.699112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206E8027F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206E8304050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206E5C6BE70>]}
[0m15:56:12.699375 [debug] [MainThread]: Flushing usage events
[0m15:56:13.019954 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:56:59.128258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D647153770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D647E66490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D64838FD90>]}


============================== 15:56:59.131937 | efb65b34-8c2b-4058-a562-d94b3b7cfe05 ==============================
[0m15:56:59.131937 [info ] [MainThread]: Running with dbt=1.10.1
[0m15:56:59.133037 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\alban.homo\\.dbt', 'log_path': 'C:\\Users\\alban.homo\\dev\\dperfmgt\\global_perfmgt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select crm_deal_quote_relevant', 'send_anonymous_usage_stats': 'True'}
[0m15:56:59.483914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'efb65b34-8c2b-4058-a562-d94b3b7cfe05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D64786EFD0>]}
[0m15:56:59.528673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'efb65b34-8c2b-4058-a562-d94b3b7cfe05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D64A2258C0>]}
[0m15:56:59.529709 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m15:56:59.700081 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m15:56:59.812321 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:56:59.813268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'efb65b34-8c2b-4058-a562-d94b3b7cfe05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D64A1D6350>]}
[0m15:57:00.415589 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'CRM_DEAL_QUOTE_RELEVANT' in the 'models' section of file 'models\example\schema.yml'
[0m15:57:00.416892 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'select_crm' in the 'models' section of file 'models\example\schema.yml'
[0m15:57:00.491496 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'CRM_DEAL_QUOTE_RELEVANT' in the 'models' section of file 'models\transform\schema.yml'
[0m15:57:00.492408 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'select_crm' in the 'models' section of file 'models\transform\schema.yml'
[0m15:57:00.493113 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two schema.yml entries for the same resource named my_first_dbt_model. Resources and their associated columns may only be described a single time. To fix this, remove the resource entry for my_first_dbt_model in one of these files:
   - models\transform\schema.yml
  models\example\schema.yml
[0m15:57:00.493997 [debug] [MainThread]: Command `dbt run` failed at 15:57:00.493904 after 1.65 seconds
[0m15:57:00.494277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D64A59F7A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D64A8C8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D64829BE70>]}
[0m15:57:00.494523 [debug] [MainThread]: Flushing usage events
[0m15:57:00.767616 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:58:19.192863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3AECE3770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3AF9E6490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3AFF0FD90>]}


============================== 15:58:19.200359 | 9f92a66f-48a8-4f82-9c99-c03fde07aa27 ==============================
[0m15:58:19.200359 [info ] [MainThread]: Running with dbt=1.10.1
[0m15:58:19.202011 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alban.homo\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\alban.homo\\dev\\dperfmgt\\global_perfmgt\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --select crm_deal_quote_relevant', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:58:19.569825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f92a66f-48a8-4f82-9c99-c03fde07aa27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3AF3EEFD0>]}
[0m15:58:19.612269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9f92a66f-48a8-4f82-9c99-c03fde07aa27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3B1DD58C0>]}
[0m15:58:19.613701 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m15:58:19.790514 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m15:58:19.911872 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:58:19.912717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9f92a66f-48a8-4f82-9c99-c03fde07aa27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3B1D86350>]}
[0m15:58:20.563372 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'CRM_DEAL_QUOTE_RELEVANT' in the 'models' section of file 'models\transform\schema.yml'
[0m15:58:20.564682 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'select_crm' in the 'models' section of file 'models\transform\schema.yml'
[0m15:58:20.565887 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_first_dbt_model' in the 'models' section of file 'models\transform\schema.yml'
[0m15:58:20.566886 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_second_dbt_model' in the 'models' section of file 'models\transform\schema.yml'
[0m15:58:20.655943 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.GLOBAL_PERFMGT.unique_CRM_DEAL_QUOTE_RELEVANT_opportunityid.cb346feb1b' (models\transform\schema.yml) depends on a node named 'CRM_DEAL_QUOTE_RELEVANT' in package '' which was not found
[0m15:58:20.656998 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.GLOBAL_PERFMGT.not_null_CRM_DEAL_QUOTE_RELEVANT_opportunityid.98ccdb2521' (models\transform\schema.yml) depends on a node named 'CRM_DEAL_QUOTE_RELEVANT' in package '' which was not found
[0m15:58:20.657819 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.GLOBAL_PERFMGT.unique_select_crm_opportunityid.677195b912' (models\transform\schema.yml) depends on a node named 'select_crm' in package '' which was not found
[0m15:58:20.658621 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.GLOBAL_PERFMGT.not_null_select_crm_opportunityid.f7dfdb021f' (models\transform\schema.yml) depends on a node named 'select_crm' in package '' which was not found
[0m15:58:20.659405 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.GLOBAL_PERFMGT.unique_my_first_dbt_model_id.16e066b321' (models\transform\schema.yml) depends on a node named 'my_first_dbt_model' in package '' which was not found
[0m15:58:20.660229 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.GLOBAL_PERFMGT.not_null_my_first_dbt_model_id.5fb22c2710' (models\transform\schema.yml) depends on a node named 'my_first_dbt_model' in package '' which was not found
[0m15:58:20.661521 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.GLOBAL_PERFMGT.unique_my_second_dbt_model_id.57a0f8c493' (models\transform\schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m15:58:20.662772 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.GLOBAL_PERFMGT.not_null_my_second_dbt_model_id.151b76d778' (models\transform\schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m15:58:20.714846 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.GLOBAL_PERFMGT.example
[0m15:58:20.718488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9f92a66f-48a8-4f82-9c99-c03fde07aa27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3B215FA70>]}
[0m15:58:20.771597 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\manifest.json
[0m15:58:20.775661 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\semantic_manifest.json
[0m15:58:20.805853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9f92a66f-48a8-4f82-9c99-c03fde07aa27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3B2585710>]}
[0m15:58:20.806285 [info ] [MainThread]: Found 1 model, 476 macros
[0m15:58:20.806929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f92a66f-48a8-4f82-9c99-c03fde07aa27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3B24E35F0>]}
[0m15:58:20.808144 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:58:20.808718 [debug] [MainThread]: Command end result
[0m15:58:20.825877 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\manifest.json
[0m15:58:20.828319 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\semantic_manifest.json
[0m15:58:20.831532 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\run_results.json
[0m15:58:20.832236 [debug] [MainThread]: Command `dbt test` succeeded at 15:58:20.832138 after 1.91 seconds
[0m15:58:20.832519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3AFC43F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3B220F280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3B220F1D0>]}
[0m15:58:20.832790 [debug] [MainThread]: Flushing usage events
[0m15:58:20.910063 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:59:05.511507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F2E5D3770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F2F2E6490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F2F80FD90>]}


============================== 15:59:05.516156 | 717fdc9e-b3b3-4b6d-bba0-084843c801bc ==============================
[0m15:59:05.516156 [info ] [MainThread]: Running with dbt=1.10.1
[0m15:59:05.517443 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\alban.homo\\.dbt', 'log_path': 'C:\\Users\\alban.homo\\dev\\dperfmgt\\global_perfmgt\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test --select crm_deal_quote_relevant', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:59:05.863187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '717fdc9e-b3b3-4b6d-bba0-084843c801bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F2ECEEFD0>]}
[0m15:59:05.902803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '717fdc9e-b3b3-4b6d-bba0-084843c801bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F316D58C0>]}
[0m15:59:05.903747 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m15:59:06.068539 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m15:59:06.234580 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:59:06.234903 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:59:06.238388 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.GLOBAL_PERFMGT.example
[0m15:59:06.250988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '717fdc9e-b3b3-4b6d-bba0-084843c801bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F31686350>]}
[0m15:59:06.306356 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\manifest.json
[0m15:59:06.310938 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\semantic_manifest.json
[0m15:59:06.336520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '717fdc9e-b3b3-4b6d-bba0-084843c801bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F31BEF6B0>]}
[0m15:59:06.336989 [info ] [MainThread]: Found 1 model, 476 macros
[0m15:59:06.337491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '717fdc9e-b3b3-4b6d-bba0-084843c801bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F31C6DFD0>]}
[0m15:59:06.338456 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:59:06.340082 [debug] [MainThread]: Command end result
[0m15:59:06.358795 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\manifest.json
[0m15:59:06.362809 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\semantic_manifest.json
[0m15:59:06.366179 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\run_results.json
[0m15:59:06.367051 [debug] [MainThread]: Command `dbt test` succeeded at 15:59:06.366938 after 1.11 seconds
[0m15:59:06.367485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F31C8FEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F2F543F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F31BF8410>]}
[0m15:59:06.367810 [debug] [MainThread]: Flushing usage events
[0m15:59:06.843701 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:59:16.377495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE54343770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE55056490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE5557FD90>]}


============================== 15:59:16.385526 | e46f3f6c-e1be-4732-858b-e93c237b2488 ==============================
[0m15:59:16.385526 [info ] [MainThread]: Running with dbt=1.10.1
[0m15:59:16.387040 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alban.homo\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\alban.homo\\dev\\dperfmgt\\global_perfmgt\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:59:16.726963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e46f3f6c-e1be-4732-858b-e93c237b2488', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE54A5EFD0>]}
[0m15:59:16.769036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e46f3f6c-e1be-4732-858b-e93c237b2488', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE574E58C0>]}
[0m15:59:16.769993 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m15:59:17.032095 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m15:59:17.263157 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:59:17.263659 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:59:17.267375 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.GLOBAL_PERFMGT.example
[0m15:59:17.290423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e46f3f6c-e1be-4732-858b-e93c237b2488', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE57495E50>]}
[0m15:59:17.421749 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\manifest.json
[0m15:59:17.429100 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\semantic_manifest.json
[0m15:59:17.459945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e46f3f6c-e1be-4732-858b-e93c237b2488', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE5434BA70>]}
[0m15:59:17.460508 [info ] [MainThread]: Found 1 model, 476 macros
[0m15:59:17.461142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e46f3f6c-e1be-4732-858b-e93c237b2488', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE57515010>]}
[0m15:59:17.463351 [info ] [MainThread]: 
[0m15:59:17.464077 [info ] [MainThread]: Concurrency: 200 threads (target='dev')
[0m15:59:17.464631 [info ] [MainThread]: 
[0m15:59:17.465344 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:59:17.466712 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_expose_dev'
[0m15:59:17.568553 [debug] [ThreadPool]: Using snowflake connection "list_expose_dev"
[0m15:59:17.568908 [debug] [ThreadPool]: On list_expose_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "connection_name": "list_expose_dev"} */
show terse schemas in database expose_dev
    limit 10000
[0m15:59:17.569121 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:59:18.094040 [debug] [ThreadPool]: SQL status: SUCCESS 54 in 0.525 seconds
[0m15:59:18.098250 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_expose_dev_dpulse'
[0m15:59:18.108110 [debug] [ThreadPool]: Using snowflake connection "list_expose_dev_dpulse"
[0m15:59:18.108472 [debug] [ThreadPool]: On list_expose_dev_dpulse: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "connection_name": "list_expose_dev_dpulse"} */
alter session set quoted_identifiers_ignore_case = false;
[0m15:59:18.108717 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:59:18.400247 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.291 seconds
[0m15:59:18.407250 [debug] [ThreadPool]: Using snowflake connection "list_expose_dev_dpulse"
[0m15:59:18.407933 [debug] [ThreadPool]: On list_expose_dev_dpulse: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "connection_name": "list_expose_dev_dpulse"} */
show objects in expose_dev.dpulse
    limit 10000
    
;
[0m15:59:18.660000 [debug] [ThreadPool]: SQL status: SUCCESS 97 in 0.251 seconds
[0m15:59:18.665628 [debug] [ThreadPool]: Using snowflake connection "list_expose_dev_dpulse"
[0m15:59:18.666193 [debug] [ThreadPool]: On list_expose_dev_dpulse: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "connection_name": "list_expose_dev_dpulse"} */
alter session unset quoted_identifiers_ignore_case;
[0m15:59:18.822153 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.155 seconds
[0m15:59:18.842554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e46f3f6c-e1be-4732-858b-e93c237b2488', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE57E97790>]}
[0m15:59:18.875209 [debug] [Thread-1 (]: Began running node model.GLOBAL_PERFMGT.crm_deal_quote_relevant
[0m15:59:18.875730 [info ] [Thread-1 (]: 1 of 1 START sql view model dpulse.crm_deal_quote_relevant ..................... [RUN]
[0m15:59:18.876343 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.GLOBAL_PERFMGT.crm_deal_quote_relevant'
[0m15:59:18.876620 [debug] [Thread-1 (]: Began compiling node model.GLOBAL_PERFMGT.crm_deal_quote_relevant
[0m15:59:18.881831 [debug] [Thread-1 (]: Writing injected SQL for node "model.GLOBAL_PERFMGT.crm_deal_quote_relevant"
[0m15:59:18.884179 [debug] [Thread-1 (]: Began executing node model.GLOBAL_PERFMGT.crm_deal_quote_relevant
[0m15:59:18.906600 [debug] [Thread-1 (]: Writing runtime sql for node "model.GLOBAL_PERFMGT.crm_deal_quote_relevant"
[0m15:59:18.910417 [debug] [Thread-1 (]: Using snowflake connection "model.GLOBAL_PERFMGT.crm_deal_quote_relevant"
[0m15:59:18.910822 [debug] [Thread-1 (]: On model.GLOBAL_PERFMGT.crm_deal_quote_relevant: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "node_id": "model.GLOBAL_PERFMGT.crm_deal_quote_relevant"} */
create or replace   view expose_dev.dpulse.crm_deal_quote_relevant
  
   as (
    

WITH LT_10 AS (
	SELECT 
		d.opportunityid, 
		d.id,
		q.quoteid,
		'10' fact_prog,
		q.name,
		q.createdon quote_createon,
		CASE WHEN MAX(q.createdon) OVER (PARTITION BY d.opportunityid) = q.createdon 
			THEN true 
			ELSE false 
		END filter,
		TO_CHAR(quote_createon,'YYYYMM') YM_START,
		NVL(TO_CHAR(datefinancialproposalagreed,'YYYYMM'),'999912') YM_END
		/*,progressiontech, datefinancialproposalagreed, datevalidated, datelegalagreement, d.createdon deal_createon, landlordsignaturedate, signaturedate,*/
	FROM finops.dwh.crm_deal d 
	LEFT JOIN finops.dwh.crm_quote q ON q.opportunityid = d.opportunityid
	WHERE --d.opportunityid='8602e810-0cb6-ee11-a569-000d3ab4b3e6' --'f1b05667-7d41-4bbc-9925-58e99d03ec9c' 
    --and 
    q.typecode ='809020000' --quote fin
    AND 
		(q.createdon< DATEADD(minute, 59, datefinancialproposalagreed ) 
		OR datefinancialproposalagreed IS NULL)
	QUALIFY filter = true
)
, LT_50 AS (
	SELECT 
		d.opportunityid, 
		d.id,
		q.quoteid,
		'50' fact_prog,
		q.name,
		q.createdon quote_createon,
		CASE WHEN min(q.createdon) OVER (PARTITION BY d.opportunityid) = q.createdon
			THEN true 
			ELSE false 
		END filter,
		TO_CHAR(quote_createon,'YYYYMM') YM_START,
		NVL(TO_CHAR(datevalidated,'YYYYMM'),'999912') YM_END
		/*,progressiontech, datefinancialproposalagreed, datevalidated, datelegalagreement, d.createdon deal_createon, landlordsignaturedate, signaturedate,*/
	FROM finops.dwh.crm_deal d 
	LEFT JOIN finops.dwh.crm_quote q ON q.opportunityid = d.opportunityid
	WHERE-- d.opportunityid='f1b05667-7d41-4bbc-9925-58e99d03ec9c'--'5b6b7053-7c73-4c7c-bd57-3fbf65bf46e9' AND
		(q.createdon< DATEADD(minute, 59, datevalidated)
		OR datevalidated IS NULL)
		AND progressiontech >= 50
		AND statereasoncode IN ('809020006','809020008') -- premiere quote valié
        and  q.typecode !='809020000' -- pas quote fin quote fin
	QUALIFY filter = true
)
, LT_70 AS (
	SELECT 
		d.opportunityid, 
		d.id,
		q.quoteid,
		'70' fact_prog,
		q.name,
		q.createdon quote_createon,
		CASE WHEN max(q.createdon) OVER (PARTITION BY d.opportunityid) = q.createdon 
			THEN true 
			ELSE false 
		END filter,
		TO_CHAR(quote_createon,'YYYYMM') YM_START,
		NVL(TO_CHAR(datelegalagreement,'YYYYMM'),'999912') YM_END
		/*,progressiontech, datefinancialproposalagreed, datevalidated, datelegalagreement, d.createdon deal_createon, landlordsignaturedate, signaturedate,*/
	FROM finops.dwh.crm_deal d 
	LEFT JOIN finops.dwh.crm_quote q ON q.opportunityid = d.opportunityid
	WHERE --d.opportunityid='f1b05667-7d41-4bbc-9925-58e99d03ec9c'--'5b6b7053-7c73-4c7c-bd57-3fbf65bf46e9' AND
		(q.createdon< DATEADD(minute, 59, datelegalagreement)
		OR datelegalagreement IS NULL)
		AND progressiontech >= 70
           and  q.typecode !='809020000' -- pas quote fin quote fin
	QUALIFY filter = true
)
, LT_90 AS (
	SELECT 
		d.opportunityid, 
		d.id,
		q.quoteid,
		'90' fact_prog,
		q.name,
		q.createdon quote_createon,
		CASE WHEN max(q.createdon) OVER (PARTITION BY d.opportunityid) = q.createdon 
			THEN true 
			ELSE false 
		END filter,
		TO_CHAR(quote_createon,'YYYYMM') YM_START,
		NVL(TO_CHAR(signaturedate,'YYYYMM'),'999912') YM_END
		/*,progressiontech, datefinancialproposalagreed, datevalidated, datelegalagreement, d.createdon deal_createon, landlordsignaturedate, signaturedate,*/
	FROM finops.dwh.crm_deal d 
	LEFT JOIN finops.dwh.crm_quote q ON q.opportunityid = d.opportunityid
	WHERE --d.opportunityid='11f976ee-4999-4f6c-beb9-12ee458a8df6'--'5b6b7053-7c73-4c7c-bd57-3fbf65bf46e9' AND 
		(q.createdon< DATEADD(minute, -1, signaturedate)
		OR signaturedate IS NULL)
		AND progressiontech >= 90
           and  q.typecode !='809020000' -- pas quote fin quote fin
	QUALIFY filter = true
)
, LT_100 AS (
	SELECT 
		d.opportunityid, 
		d.id,
		q.quoteid,
		'100' fact_prog,
		q.name,
		q.createdon quote_createon,
		true filter,
		TO_CHAR(quote_createon,'YYYYMM') YM_START,
		NVL(TO_CHAR(signaturedate,'YYYYMM'),'999912') YM_END
		/*,progressiontech, datefinancialproposalagreed, datevalidated, datelegalagreement, d.createdon deal_createon, landlordsignaturedate, signaturedate,*/
	FROM finops.dwh.crm_deal d 
	 left JOIN finops.dwh.crm_quote q ON q.opportunityid = d.opportunityid AND 
    d.quoteid = q.quoteid
	WHERE --d.opportunityid='6d4a9d80-bd0b-ef11-9f89-000d3abaebc4' AND
		progressiontech = 100
)
SELECT * exclude(filter)
FROM
(
	SELECT * FROM LT_10
	UNION ALL
	SELECT * FROM LT_50
	UNION ALL
	SELECT * FROM LT_70
	UNION ALL
	SELECT * FROM LT_90
	UNION ALL
	SELECT * FROM LT_100);
[0m15:59:18.911179 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:59:19.291559 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bd1747-0106-9ec8-0000-03a97f8c9232
[0m15:59:19.292343 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): Erreur de compilation SQL :
ligne d'erreur de syntaxe 133 à la position 22, « ; » inattendu.
[0m15:59:19.303545 [debug] [Thread-1 (]: Database Error in model crm_deal_quote_relevant (models\transform\crm_deal_quote_relevant.sql)
  001003 (42000): Erreur de compilation SQL :
  ligne d'erreur de syntaxe 133 à la position 22, « ; » inattendu.
  compiled code at target\run\GLOBAL_PERFMGT\models\transform\crm_deal_quote_relevant.sql
[0m15:59:19.306347 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e46f3f6c-e1be-4732-858b-e93c237b2488', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE58185E50>]}
[0m15:59:19.307027 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dpulse.crm_deal_quote_relevant ............ [[31mERROR[0m in 0.43s]
[0m15:59:19.307820 [debug] [Thread-1 (]: Finished running node model.GLOBAL_PERFMGT.crm_deal_quote_relevant
[0m15:59:19.308303 [debug] [Thread-203]: Marking all children of 'model.GLOBAL_PERFMGT.crm_deal_quote_relevant' to be skipped because of status 'error'.  Reason: Database Error in model crm_deal_quote_relevant (models\transform\crm_deal_quote_relevant.sql)
  001003 (42000): Erreur de compilation SQL :
  ligne d'erreur de syntaxe 133 à la position 22, « ; » inattendu.
  compiled code at target\run\GLOBAL_PERFMGT\models\transform\crm_deal_quote_relevant.sql.
[0m15:59:19.317821 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:59:19.318117 [debug] [MainThread]: Connection 'list_expose_dev' was left open.
[0m15:59:19.318388 [debug] [MainThread]: On list_expose_dev: Close
[0m15:59:19.406916 [debug] [MainThread]: Connection 'list_expose_dev_dpulse' was left open.
[0m15:59:19.407971 [debug] [MainThread]: On list_expose_dev_dpulse: Close
[0m15:59:19.492594 [debug] [MainThread]: Connection 'model.GLOBAL_PERFMGT.crm_deal_quote_relevant' was left open.
[0m15:59:19.493664 [debug] [MainThread]: On model.GLOBAL_PERFMGT.crm_deal_quote_relevant: Close
[0m15:59:19.589448 [info ] [MainThread]: 
[0m15:59:19.590786 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.12 seconds (2.12s).
[0m15:59:19.592594 [debug] [MainThread]: Command end result
[0m15:59:19.617867 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\manifest.json
[0m15:59:19.620634 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\semantic_manifest.json
[0m15:59:19.628169 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\run_results.json
[0m15:59:19.628517 [info ] [MainThread]: 
[0m15:59:19.629358 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:59:19.629925 [info ] [MainThread]: 
[0m15:59:19.630433 [error] [MainThread]: [31mFailure in model crm_deal_quote_relevant (models\transform\crm_deal_quote_relevant.sql)[0m
[0m15:59:19.630956 [error] [MainThread]:   Database Error in model crm_deal_quote_relevant (models\transform\crm_deal_quote_relevant.sql)
  001003 (42000): Erreur de compilation SQL :
  ligne d'erreur de syntaxe 133 à la position 22, « ; » inattendu.
  compiled code at target\run\GLOBAL_PERFMGT\models\transform\crm_deal_quote_relevant.sql
[0m15:59:19.631426 [info ] [MainThread]: 
[0m15:59:19.631957 [info ] [MainThread]:   compiled code at target\compiled\GLOBAL_PERFMGT\models\transform\crm_deal_quote_relevant.sql
[0m15:59:19.632388 [info ] [MainThread]: 
[0m15:59:19.632827 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m15:59:19.633573 [debug] [MainThread]: Command `dbt run` failed at 15:59:19.633482 after 3.49 seconds
[0m15:59:19.633855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE57EDEC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE580E80F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE580EBBB0>]}
[0m15:59:19.634101 [debug] [MainThread]: Flushing usage events
[0m15:59:19.684545 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:59:53.876535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DB84203770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DB84F06490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DB8542FD90>]}


============================== 15:59:53.880260 | 2c137a4e-13c3-4fac-8191-d4824ec40e3a ==============================
[0m15:59:53.880260 [info ] [MainThread]: Running with dbt=1.10.1
[0m15:59:53.881186 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\alban.homo\\dev\\dperfmgt\\global_perfmgt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\alban.homo\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:59:54.236666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c137a4e-13c3-4fac-8191-d4824ec40e3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DB8490AFD0>]}
[0m15:59:54.277133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c137a4e-13c3-4fac-8191-d4824ec40e3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DB873F58C0>]}
[0m15:59:54.278079 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m15:59:54.440511 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m15:59:54.597241 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:59:54.597566 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:59:54.601000 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.GLOBAL_PERFMGT.example
[0m15:59:54.615018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c137a4e-13c3-4fac-8191-d4824ec40e3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DB873A5E50>]}
[0m15:59:54.670261 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\manifest.json
[0m15:59:54.674223 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\semantic_manifest.json
[0m15:59:54.691660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c137a4e-13c3-4fac-8191-d4824ec40e3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DB8420BA70>]}
[0m15:59:54.692069 [info ] [MainThread]: Found 1 model, 476 macros
[0m15:59:54.692802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c137a4e-13c3-4fac-8191-d4824ec40e3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DB87425010>]}
[0m15:59:54.693994 [info ] [MainThread]: 
[0m15:59:54.694692 [info ] [MainThread]: Concurrency: 200 threads (target='dev')
[0m15:59:54.695218 [info ] [MainThread]: 
[0m15:59:54.695811 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:59:54.696959 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_expose_dev'
[0m15:59:54.781605 [debug] [ThreadPool]: Using snowflake connection "list_expose_dev"
[0m15:59:54.781924 [debug] [ThreadPool]: On list_expose_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "connection_name": "list_expose_dev"} */
show terse schemas in database expose_dev
    limit 10000
[0m15:59:54.782131 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:59:55.494730 [debug] [ThreadPool]: SQL status: SUCCESS 54 in 0.712 seconds
[0m15:59:55.501929 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_expose_dev_dpulse'
[0m15:59:55.514958 [debug] [ThreadPool]: Using snowflake connection "list_expose_dev_dpulse"
[0m15:59:55.515317 [debug] [ThreadPool]: On list_expose_dev_dpulse: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "connection_name": "list_expose_dev_dpulse"} */
alter session set quoted_identifiers_ignore_case = false;
[0m15:59:55.515541 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:59:56.262320 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.747 seconds
[0m15:59:56.270531 [debug] [ThreadPool]: Using snowflake connection "list_expose_dev_dpulse"
[0m15:59:56.271634 [debug] [ThreadPool]: On list_expose_dev_dpulse: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "connection_name": "list_expose_dev_dpulse"} */
show objects in expose_dev.dpulse
    limit 10000
    
;
[0m15:59:56.518245 [debug] [ThreadPool]: SQL status: SUCCESS 97 in 0.246 seconds
[0m15:59:56.523130 [debug] [ThreadPool]: Using snowflake connection "list_expose_dev_dpulse"
[0m15:59:56.523630 [debug] [ThreadPool]: On list_expose_dev_dpulse: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "connection_name": "list_expose_dev_dpulse"} */
alter session unset quoted_identifiers_ignore_case;
[0m15:59:56.673225 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.149 seconds
[0m15:59:56.682863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c137a4e-13c3-4fac-8191-d4824ec40e3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DB87DA7790>]}
[0m15:59:56.722288 [debug] [Thread-1 (]: Began running node model.GLOBAL_PERFMGT.crm_deal_quote_relevant
[0m15:59:56.722877 [info ] [Thread-1 (]: 1 of 1 START sql view model dpulse.crm_deal_quote_relevant ..................... [RUN]
[0m15:59:56.723491 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.GLOBAL_PERFMGT.crm_deal_quote_relevant'
[0m15:59:56.723823 [debug] [Thread-1 (]: Began compiling node model.GLOBAL_PERFMGT.crm_deal_quote_relevant
[0m15:59:56.729552 [debug] [Thread-1 (]: Writing injected SQL for node "model.GLOBAL_PERFMGT.crm_deal_quote_relevant"
[0m15:59:56.731635 [debug] [Thread-1 (]: Began executing node model.GLOBAL_PERFMGT.crm_deal_quote_relevant
[0m15:59:56.756051 [debug] [Thread-1 (]: Writing runtime sql for node "model.GLOBAL_PERFMGT.crm_deal_quote_relevant"
[0m15:59:56.759861 [debug] [Thread-1 (]: Using snowflake connection "model.GLOBAL_PERFMGT.crm_deal_quote_relevant"
[0m15:59:56.760344 [debug] [Thread-1 (]: On model.GLOBAL_PERFMGT.crm_deal_quote_relevant: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "node_id": "model.GLOBAL_PERFMGT.crm_deal_quote_relevant"} */
create or replace   view expose_dev.dpulse.crm_deal_quote_relevant
  
   as (
    

WITH LT_10 AS (
	SELECT 
		d.opportunityid, 
		d.id,
		q.quoteid,
		'10' fact_prog,
		q.name,
		q.createdon quote_createon,
		CASE WHEN MAX(q.createdon) OVER (PARTITION BY d.opportunityid) = q.createdon 
			THEN true 
			ELSE false 
		END filter,
		TO_CHAR(quote_createon,'YYYYMM') YM_START,
		NVL(TO_CHAR(datefinancialproposalagreed,'YYYYMM'),'999912') YM_END
		/*,progressiontech, datefinancialproposalagreed, datevalidated, datelegalagreement, d.createdon deal_createon, landlordsignaturedate, signaturedate,*/
	FROM finops.dwh.crm_deal d 
	LEFT JOIN finops.dwh.crm_quote q ON q.opportunityid = d.opportunityid
	WHERE --d.opportunityid='8602e810-0cb6-ee11-a569-000d3ab4b3e6' --'f1b05667-7d41-4bbc-9925-58e99d03ec9c' 
    --and 
    q.typecode ='809020000' --quote fin
    AND 
		(q.createdon< DATEADD(minute, 59, datefinancialproposalagreed ) 
		OR datefinancialproposalagreed IS NULL)
	QUALIFY filter = true
)
, LT_50 AS (
	SELECT 
		d.opportunityid, 
		d.id,
		q.quoteid,
		'50' fact_prog,
		q.name,
		q.createdon quote_createon,
		CASE WHEN min(q.createdon) OVER (PARTITION BY d.opportunityid) = q.createdon
			THEN true 
			ELSE false 
		END filter,
		TO_CHAR(quote_createon,'YYYYMM') YM_START,
		NVL(TO_CHAR(datevalidated,'YYYYMM'),'999912') YM_END
		/*,progressiontech, datefinancialproposalagreed, datevalidated, datelegalagreement, d.createdon deal_createon, landlordsignaturedate, signaturedate,*/
	FROM finops.dwh.crm_deal d 
	LEFT JOIN finops.dwh.crm_quote q ON q.opportunityid = d.opportunityid
	WHERE-- d.opportunityid='f1b05667-7d41-4bbc-9925-58e99d03ec9c'--'5b6b7053-7c73-4c7c-bd57-3fbf65bf46e9' AND
		(q.createdon< DATEADD(minute, 59, datevalidated)
		OR datevalidated IS NULL)
		AND progressiontech >= 50
		AND statereasoncode IN ('809020006','809020008') -- premiere quote valié
        and  q.typecode !='809020000' -- pas quote fin quote fin
	QUALIFY filter = true
)
, LT_70 AS (
	SELECT 
		d.opportunityid, 
		d.id,
		q.quoteid,
		'70' fact_prog,
		q.name,
		q.createdon quote_createon,
		CASE WHEN max(q.createdon) OVER (PARTITION BY d.opportunityid) = q.createdon 
			THEN true 
			ELSE false 
		END filter,
		TO_CHAR(quote_createon,'YYYYMM') YM_START,
		NVL(TO_CHAR(datelegalagreement,'YYYYMM'),'999912') YM_END
		/*,progressiontech, datefinancialproposalagreed, datevalidated, datelegalagreement, d.createdon deal_createon, landlordsignaturedate, signaturedate,*/
	FROM finops.dwh.crm_deal d 
	LEFT JOIN finops.dwh.crm_quote q ON q.opportunityid = d.opportunityid
	WHERE --d.opportunityid='f1b05667-7d41-4bbc-9925-58e99d03ec9c'--'5b6b7053-7c73-4c7c-bd57-3fbf65bf46e9' AND
		(q.createdon< DATEADD(minute, 59, datelegalagreement)
		OR datelegalagreement IS NULL)
		AND progressiontech >= 70
           and  q.typecode !='809020000' -- pas quote fin quote fin
	QUALIFY filter = true
)
, LT_90 AS (
	SELECT 
		d.opportunityid, 
		d.id,
		q.quoteid,
		'90' fact_prog,
		q.name,
		q.createdon quote_createon,
		CASE WHEN max(q.createdon) OVER (PARTITION BY d.opportunityid) = q.createdon 
			THEN true 
			ELSE false 
		END filter,
		TO_CHAR(quote_createon,'YYYYMM') YM_START,
		NVL(TO_CHAR(signaturedate,'YYYYMM'),'999912') YM_END
		/*,progressiontech, datefinancialproposalagreed, datevalidated, datelegalagreement, d.createdon deal_createon, landlordsignaturedate, signaturedate,*/
	FROM finops.dwh.crm_deal d 
	LEFT JOIN finops.dwh.crm_quote q ON q.opportunityid = d.opportunityid
	WHERE --d.opportunityid='11f976ee-4999-4f6c-beb9-12ee458a8df6'--'5b6b7053-7c73-4c7c-bd57-3fbf65bf46e9' AND 
		(q.createdon< DATEADD(minute, -1, signaturedate)
		OR signaturedate IS NULL)
		AND progressiontech >= 90
           and  q.typecode !='809020000' -- pas quote fin quote fin
	QUALIFY filter = true
)
, LT_100 AS (
	SELECT 
		d.opportunityid, 
		d.id,
		q.quoteid,
		'100' fact_prog,
		q.name,
		q.createdon quote_createon,
		true filter,
		TO_CHAR(quote_createon,'YYYYMM') YM_START,
		NVL(TO_CHAR(signaturedate,'YYYYMM'),'999912') YM_END
		/*,progressiontech, datefinancialproposalagreed, datevalidated, datelegalagreement, d.createdon deal_createon, landlordsignaturedate, signaturedate,*/
	FROM finops.dwh.crm_deal d 
	 left JOIN finops.dwh.crm_quote q ON q.opportunityid = d.opportunityid AND 
    d.quoteid = q.quoteid
	WHERE --d.opportunityid='6d4a9d80-bd0b-ef11-9f89-000d3abaebc4' AND
		progressiontech = 100
)
SELECT * exclude(filter)
FROM
(
	SELECT * FROM LT_10
	UNION ALL
	SELECT * FROM LT_50
	UNION ALL
	SELECT * FROM LT_70
	UNION ALL
	SELECT * FROM LT_90
	UNION ALL
	SELECT * FROM LT_100);
[0m15:59:56.760713 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:59:57.350792 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bd1747-0106-9f4f-0000-03a97f8c8a3a
[0m15:59:57.351187 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): Erreur de compilation SQL :
ligne d'erreur de syntaxe 133 à la position 22, « ; » inattendu.
[0m15:59:57.357793 [debug] [Thread-1 (]: Database Error in model crm_deal_quote_relevant (models\transform\crm_deal_quote_relevant.sql)
  001003 (42000): Erreur de compilation SQL :
  ligne d'erreur de syntaxe 133 à la position 22, « ; » inattendu.
  compiled code at target\run\GLOBAL_PERFMGT\models\transform\crm_deal_quote_relevant.sql
[0m15:59:57.359732 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c137a4e-13c3-4fac-8191-d4824ec40e3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DB88091E50>]}
[0m15:59:57.360443 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dpulse.crm_deal_quote_relevant ............ [[31mERROR[0m in 0.63s]
[0m15:59:57.361556 [debug] [Thread-1 (]: Finished running node model.GLOBAL_PERFMGT.crm_deal_quote_relevant
[0m15:59:57.362200 [debug] [Thread-203]: Marking all children of 'model.GLOBAL_PERFMGT.crm_deal_quote_relevant' to be skipped because of status 'error'.  Reason: Database Error in model crm_deal_quote_relevant (models\transform\crm_deal_quote_relevant.sql)
  001003 (42000): Erreur de compilation SQL :
  ligne d'erreur de syntaxe 133 à la position 22, « ; » inattendu.
  compiled code at target\run\GLOBAL_PERFMGT\models\transform\crm_deal_quote_relevant.sql.
[0m15:59:57.384138 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:59:57.384663 [debug] [MainThread]: Connection 'list_expose_dev' was left open.
[0m15:59:57.385004 [debug] [MainThread]: On list_expose_dev: Close
[0m15:59:57.513966 [debug] [MainThread]: Connection 'list_expose_dev_dpulse' was left open.
[0m15:59:57.514649 [debug] [MainThread]: On list_expose_dev_dpulse: Close
[0m15:59:57.734315 [debug] [MainThread]: Connection 'model.GLOBAL_PERFMGT.crm_deal_quote_relevant' was left open.
[0m15:59:57.734918 [debug] [MainThread]: On model.GLOBAL_PERFMGT.crm_deal_quote_relevant: Close
[0m15:59:57.921814 [info ] [MainThread]: 
[0m15:59:57.922561 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.23 seconds (3.23s).
[0m15:59:57.923385 [debug] [MainThread]: Command end result
[0m15:59:57.944855 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\manifest.json
[0m15:59:57.947955 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\semantic_manifest.json
[0m15:59:57.954313 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\run_results.json
[0m15:59:57.954639 [info ] [MainThread]: 
[0m15:59:57.955389 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:59:57.956144 [info ] [MainThread]: 
[0m15:59:57.956694 [error] [MainThread]: [31mFailure in model crm_deal_quote_relevant (models\transform\crm_deal_quote_relevant.sql)[0m
[0m15:59:57.957322 [error] [MainThread]:   Database Error in model crm_deal_quote_relevant (models\transform\crm_deal_quote_relevant.sql)
  001003 (42000): Erreur de compilation SQL :
  ligne d'erreur de syntaxe 133 à la position 22, « ; » inattendu.
  compiled code at target\run\GLOBAL_PERFMGT\models\transform\crm_deal_quote_relevant.sql
[0m15:59:57.957881 [info ] [MainThread]: 
[0m15:59:57.958453 [info ] [MainThread]:   compiled code at target\compiled\GLOBAL_PERFMGT\models\transform\crm_deal_quote_relevant.sql
[0m15:59:57.959036 [info ] [MainThread]: 
[0m15:59:57.959579 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m15:59:57.960497 [debug] [MainThread]: Command `dbt run` failed at 15:59:57.960402 after 4.32 seconds
[0m15:59:57.960868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DB87DEEC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DB87FF80F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DB87FFBBB0>]}
[0m15:59:57.961350 [debug] [MainThread]: Flushing usage events
[0m15:59:58.213317 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:49:32.021141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020110FD3770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020111CD6490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201121FFD90>]}


============================== 17:49:32.031127 | c27c04ac-161d-4942-ae60-48e18b8e75da ==============================
[0m17:49:32.031127 [info ] [MainThread]: Running with dbt=1.10.1
[0m17:49:32.032047 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\alban.homo\\dev\\dperfmgt\\global_perfmgt\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\alban.homo\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:49:32.543400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c27c04ac-161d-4942-ae60-48e18b8e75da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201116DEFD0>]}
[0m17:49:32.583495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c27c04ac-161d-4942-ae60-48e18b8e75da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201140F58C0>]}
[0m17:49:32.584656 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m17:49:32.809197 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m17:49:32.955133 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:49:32.955439 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:49:32.959042 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.GLOBAL_PERFMGT.example
[0m17:49:32.971573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c27c04ac-161d-4942-ae60-48e18b8e75da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201140A5E50>]}
[0m17:49:33.028397 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\manifest.json
[0m17:49:33.036150 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\semantic_manifest.json
[0m17:49:33.069627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c27c04ac-161d-4942-ae60-48e18b8e75da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020110FDBA70>]}
[0m17:49:33.070052 [info ] [MainThread]: Found 1 model, 476 macros
[0m17:49:33.070802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c27c04ac-161d-4942-ae60-48e18b8e75da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020114125010>]}
[0m17:49:33.072575 [info ] [MainThread]: 
[0m17:49:33.073375 [info ] [MainThread]: Concurrency: 200 threads (target='dev')
[0m17:49:33.073807 [info ] [MainThread]: 
[0m17:49:33.074354 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:49:33.076066 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_expose_dev'
[0m17:49:33.200873 [debug] [ThreadPool]: Using snowflake connection "list_expose_dev"
[0m17:49:33.201180 [debug] [ThreadPool]: On list_expose_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "connection_name": "list_expose_dev"} */
show terse schemas in database expose_dev
    limit 10000
[0m17:49:33.201370 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:49:33.971935 [debug] [ThreadPool]: SQL status: SUCCESS 54 in 0.770 seconds
[0m17:49:33.978838 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_expose_dev_dpulse'
[0m17:49:33.993341 [debug] [ThreadPool]: Using snowflake connection "list_expose_dev_dpulse"
[0m17:49:33.993779 [debug] [ThreadPool]: On list_expose_dev_dpulse: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "connection_name": "list_expose_dev_dpulse"} */
alter session set quoted_identifiers_ignore_case = false;
[0m17:49:33.994091 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:49:34.287812 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.294 seconds
[0m17:49:34.294763 [debug] [ThreadPool]: Using snowflake connection "list_expose_dev_dpulse"
[0m17:49:34.295403 [debug] [ThreadPool]: On list_expose_dev_dpulse: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "connection_name": "list_expose_dev_dpulse"} */
show objects in expose_dev.dpulse
    limit 10000
    
;
[0m17:49:34.535860 [debug] [ThreadPool]: SQL status: SUCCESS 97 in 0.240 seconds
[0m17:49:34.541546 [debug] [ThreadPool]: Using snowflake connection "list_expose_dev_dpulse"
[0m17:49:34.542149 [debug] [ThreadPool]: On list_expose_dev_dpulse: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "connection_name": "list_expose_dev_dpulse"} */
alter session unset quoted_identifiers_ignore_case;
[0m17:49:34.611670 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.069 seconds
[0m17:49:34.630103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c27c04ac-161d-4942-ae60-48e18b8e75da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020114AC7790>]}
[0m17:49:34.688712 [debug] [Thread-1 (]: Began running node model.GLOBAL_PERFMGT.crm_deal_quote_relevant
[0m17:49:34.689213 [info ] [Thread-1 (]: 1 of 1 START sql view model dpulse.crm_deal_quote_relevant ..................... [RUN]
[0m17:49:34.689898 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.GLOBAL_PERFMGT.crm_deal_quote_relevant'
[0m17:49:34.690168 [debug] [Thread-1 (]: Began compiling node model.GLOBAL_PERFMGT.crm_deal_quote_relevant
[0m17:49:34.694677 [debug] [Thread-1 (]: Writing injected SQL for node "model.GLOBAL_PERFMGT.crm_deal_quote_relevant"
[0m17:49:34.697188 [debug] [Thread-1 (]: Began executing node model.GLOBAL_PERFMGT.crm_deal_quote_relevant
[0m17:49:34.716699 [debug] [Thread-1 (]: Writing runtime sql for node "model.GLOBAL_PERFMGT.crm_deal_quote_relevant"
[0m17:49:34.720302 [debug] [Thread-1 (]: Using snowflake connection "model.GLOBAL_PERFMGT.crm_deal_quote_relevant"
[0m17:49:34.720800 [debug] [Thread-1 (]: On model.GLOBAL_PERFMGT.crm_deal_quote_relevant: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "node_id": "model.GLOBAL_PERFMGT.crm_deal_quote_relevant"} */
create or replace   view expose_dev.dpulse.crm_deal_quote_relevant
  
   as (
    

WITH LT_10 AS (
	SELECT 
		d.opportunityid, 
		d.id,
		q.quoteid,
		'10' fact_prog,
		q.name,
		q.createdon quote_createon,
		CASE WHEN MAX(q.createdon) OVER (PARTITION BY d.opportunityid) = q.createdon 
			THEN true 
			ELSE false 
		END filter,
		TO_CHAR(quote_createon,'YYYYMM') YM_START,
		NVL(TO_CHAR(datefinancialproposalagreed,'YYYYMM'),'999912') YM_END
		/*,progressiontech, datefinancialproposalagreed, datevalidated, datelegalagreement, d.createdon deal_createon, landlordsignaturedate, signaturedate,*/
	FROM finops.dwh.crm_deal d 
	LEFT JOIN finops.dwh.crm_quote q ON q.opportunityid = d.opportunityid
	WHERE --d.opportunityid='8602e810-0cb6-ee11-a569-000d3ab4b3e6' --'f1b05667-7d41-4bbc-9925-58e99d03ec9c' 
    --and 
    q.typecode ='809020000' --quote fin
    AND 
		(q.createdon< DATEADD(minute, 59, datefinancialproposalagreed ) 
		OR datefinancialproposalagreed IS NULL)
	QUALIFY filter = true
)
, LT_50 AS (
	SELECT 
		d.opportunityid, 
		d.id,
		q.quoteid,
		'50' fact_prog,
		q.name,
		q.createdon quote_createon,
		CASE WHEN min(q.createdon) OVER (PARTITION BY d.opportunityid) = q.createdon
			THEN true 
			ELSE false 
		END filter,
		TO_CHAR(quote_createon,'YYYYMM') YM_START,
		NVL(TO_CHAR(datevalidated,'YYYYMM'),'999912') YM_END
		/*,progressiontech, datefinancialproposalagreed, datevalidated, datelegalagreement, d.createdon deal_createon, landlordsignaturedate, signaturedate,*/
	FROM finops.dwh.crm_deal d 
	LEFT JOIN finops.dwh.crm_quote q ON q.opportunityid = d.opportunityid
	WHERE-- d.opportunityid='f1b05667-7d41-4bbc-9925-58e99d03ec9c'--'5b6b7053-7c73-4c7c-bd57-3fbf65bf46e9' AND
		(q.createdon< DATEADD(minute, 59, datevalidated)
		OR datevalidated IS NULL)
		AND progressiontech >= 50
		AND statereasoncode IN ('809020006','809020008') -- premiere quote valié
        and  q.typecode !='809020000' -- pas quote fin quote fin
	QUALIFY filter = true
)
, LT_70 AS (
	SELECT 
		d.opportunityid, 
		d.id,
		q.quoteid,
		'70' fact_prog,
		q.name,
		q.createdon quote_createon,
		CASE WHEN max(q.createdon) OVER (PARTITION BY d.opportunityid) = q.createdon 
			THEN true 
			ELSE false 
		END filter,
		TO_CHAR(quote_createon,'YYYYMM') YM_START,
		NVL(TO_CHAR(datelegalagreement,'YYYYMM'),'999912') YM_END
		/*,progressiontech, datefinancialproposalagreed, datevalidated, datelegalagreement, d.createdon deal_createon, landlordsignaturedate, signaturedate,*/
	FROM finops.dwh.crm_deal d 
	LEFT JOIN finops.dwh.crm_quote q ON q.opportunityid = d.opportunityid
	WHERE --d.opportunityid='f1b05667-7d41-4bbc-9925-58e99d03ec9c'--'5b6b7053-7c73-4c7c-bd57-3fbf65bf46e9' AND
		(q.createdon< DATEADD(minute, 59, datelegalagreement)
		OR datelegalagreement IS NULL)
		AND progressiontech >= 70
           and  q.typecode !='809020000' -- pas quote fin quote fin
	QUALIFY filter = true
)
, LT_90 AS (
	SELECT 
		d.opportunityid, 
		d.id,
		q.quoteid,
		'90' fact_prog,
		q.name,
		q.createdon quote_createon,
		CASE WHEN max(q.createdon) OVER (PARTITION BY d.opportunityid) = q.createdon 
			THEN true 
			ELSE false 
		END filter,
		TO_CHAR(quote_createon,'YYYYMM') YM_START,
		NVL(TO_CHAR(signaturedate,'YYYYMM'),'999912') YM_END
		/*,progressiontech, datefinancialproposalagreed, datevalidated, datelegalagreement, d.createdon deal_createon, landlordsignaturedate, signaturedate,*/
	FROM finops.dwh.crm_deal d 
	LEFT JOIN finops.dwh.crm_quote q ON q.opportunityid = d.opportunityid
	WHERE --d.opportunityid='11f976ee-4999-4f6c-beb9-12ee458a8df6'--'5b6b7053-7c73-4c7c-bd57-3fbf65bf46e9' AND 
		(q.createdon< DATEADD(minute, -1, signaturedate)
		OR signaturedate IS NULL)
		AND progressiontech >= 90
           and  q.typecode !='809020000' -- pas quote fin quote fin
	QUALIFY filter = true
)
, LT_100 AS (
	SELECT 
		d.opportunityid, 
		d.id,
		q.quoteid,
		'100' fact_prog,
		q.name,
		q.createdon quote_createon,
		true filter,
		TO_CHAR(quote_createon,'YYYYMM') YM_START,
		NVL(TO_CHAR(signaturedate,'YYYYMM'),'999912') YM_END
		/*,progressiontech, datefinancialproposalagreed, datevalidated, datelegalagreement, d.createdon deal_createon, landlordsignaturedate, signaturedate,*/
	FROM finops.dwh.crm_deal d 
	 left JOIN finops.dwh.crm_quote q ON q.opportunityid = d.opportunityid AND 
    d.quoteid = q.quoteid
	WHERE --d.opportunityid='6d4a9d80-bd0b-ef11-9f89-000d3abaebc4' AND
		progressiontech = 100
)
SELECT * exclude(filter)
FROM
(
	SELECT * FROM LT_10
	UNION ALL
	SELECT * FROM LT_50
	UNION ALL
	SELECT * FROM LT_70
	UNION ALL
	SELECT * FROM LT_90
	UNION ALL
	SELECT * FROM LT_100);
[0m17:49:34.721206 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:49:35.022054 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bd17b5-0106-9eb9-0000-03a97f90818a
[0m17:49:35.022795 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): Erreur de compilation SQL :
ligne d'erreur de syntaxe 133 à la position 22, « ; » inattendu.
[0m17:49:35.032744 [debug] [Thread-1 (]: Database Error in model crm_deal_quote_relevant (models\transform\crm_deal_quote_relevant.sql)
  001003 (42000): Erreur de compilation SQL :
  ligne d'erreur de syntaxe 133 à la position 22, « ; » inattendu.
  compiled code at target\run\GLOBAL_PERFMGT\models\transform\crm_deal_quote_relevant.sql
[0m17:49:35.035207 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c27c04ac-161d-4942-ae60-48e18b8e75da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020114D95E50>]}
[0m17:49:35.035871 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dpulse.crm_deal_quote_relevant ............ [[31mERROR[0m in 0.34s]
[0m17:49:35.036558 [debug] [Thread-1 (]: Finished running node model.GLOBAL_PERFMGT.crm_deal_quote_relevant
[0m17:49:35.036988 [debug] [Thread-203]: Marking all children of 'model.GLOBAL_PERFMGT.crm_deal_quote_relevant' to be skipped because of status 'error'.  Reason: Database Error in model crm_deal_quote_relevant (models\transform\crm_deal_quote_relevant.sql)
  001003 (42000): Erreur de compilation SQL :
  ligne d'erreur de syntaxe 133 à la position 22, « ; » inattendu.
  compiled code at target\run\GLOBAL_PERFMGT\models\transform\crm_deal_quote_relevant.sql.
[0m17:49:35.046513 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:49:35.046859 [debug] [MainThread]: Connection 'list_expose_dev' was left open.
[0m17:49:35.047093 [debug] [MainThread]: On list_expose_dev: Close
[0m17:49:35.143091 [debug] [MainThread]: Connection 'list_expose_dev_dpulse' was left open.
[0m17:49:35.145758 [debug] [MainThread]: On list_expose_dev_dpulse: Close
[0m17:49:35.244746 [debug] [MainThread]: Connection 'model.GLOBAL_PERFMGT.crm_deal_quote_relevant' was left open.
[0m17:49:35.245656 [debug] [MainThread]: On model.GLOBAL_PERFMGT.crm_deal_quote_relevant: Close
[0m17:49:35.333970 [info ] [MainThread]: 
[0m17:49:35.335587 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.26 seconds (2.26s).
[0m17:49:35.337441 [debug] [MainThread]: Command end result
[0m17:49:35.367303 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\manifest.json
[0m17:49:35.370213 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\semantic_manifest.json
[0m17:49:35.376275 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\run_results.json
[0m17:49:35.376649 [info ] [MainThread]: 
[0m17:49:35.377579 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:49:35.378223 [info ] [MainThread]: 
[0m17:49:35.378886 [error] [MainThread]: [31mFailure in model crm_deal_quote_relevant (models\transform\crm_deal_quote_relevant.sql)[0m
[0m17:49:35.379388 [error] [MainThread]:   Database Error in model crm_deal_quote_relevant (models\transform\crm_deal_quote_relevant.sql)
  001003 (42000): Erreur de compilation SQL :
  ligne d'erreur de syntaxe 133 à la position 22, « ; » inattendu.
  compiled code at target\run\GLOBAL_PERFMGT\models\transform\crm_deal_quote_relevant.sql
[0m17:49:35.379871 [info ] [MainThread]: 
[0m17:49:35.380367 [info ] [MainThread]:   compiled code at target\compiled\GLOBAL_PERFMGT\models\transform\crm_deal_quote_relevant.sql
[0m17:49:35.380808 [info ] [MainThread]: 
[0m17:49:35.381235 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m17:49:35.382008 [debug] [MainThread]: Command `dbt run` failed at 17:49:35.381912 after 3.64 seconds
[0m17:49:35.382317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020114AEEC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020114CF80F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020114CFBBB0>]}
[0m17:49:35.382570 [debug] [MainThread]: Flushing usage events
[0m17:49:35.742820 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:50:20.180557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B924F03770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B925C06490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B92612FD90>]}


============================== 17:50:20.186991 | 1465e9be-3706-4859-89a1-9c04b60ad750 ==============================
[0m17:50:20.186991 [info ] [MainThread]: Running with dbt=1.10.1
[0m17:50:20.188369 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alban.homo\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\alban.homo\\dev\\dperfmgt\\global_perfmgt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:50:20.538160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1465e9be-3706-4859-89a1-9c04b60ad750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B92560EFD0>]}
[0m17:50:20.579093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1465e9be-3706-4859-89a1-9c04b60ad750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9280E58C0>]}
[0m17:50:20.580097 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m17:50:20.764175 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m17:50:20.914843 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:50:20.915279 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:50:20.918868 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.GLOBAL_PERFMGT.example
[0m17:50:20.931725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1465e9be-3706-4859-89a1-9c04b60ad750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B928095E50>]}
[0m17:50:20.989357 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\manifest.json
[0m17:50:20.993460 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\semantic_manifest.json
[0m17:50:21.011553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1465e9be-3706-4859-89a1-9c04b60ad750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B924F0BA70>]}
[0m17:50:21.011988 [info ] [MainThread]: Found 1 model, 476 macros
[0m17:50:21.012684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1465e9be-3706-4859-89a1-9c04b60ad750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B928115010>]}
[0m17:50:21.013919 [info ] [MainThread]: 
[0m17:50:21.014656 [info ] [MainThread]: Concurrency: 200 threads (target='dev')
[0m17:50:21.015124 [info ] [MainThread]: 
[0m17:50:21.015765 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:50:21.017009 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_expose_dev'
[0m17:50:21.101179 [debug] [ThreadPool]: Using snowflake connection "list_expose_dev"
[0m17:50:21.101510 [debug] [ThreadPool]: On list_expose_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "connection_name": "list_expose_dev"} */
show terse schemas in database expose_dev
    limit 10000
[0m17:50:21.101777 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:21.834382 [debug] [ThreadPool]: SQL status: SUCCESS 54 in 0.732 seconds
[0m17:50:21.840911 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_expose_dev_dpulse'
[0m17:50:21.851776 [debug] [ThreadPool]: Using snowflake connection "list_expose_dev_dpulse"
[0m17:50:21.852161 [debug] [ThreadPool]: On list_expose_dev_dpulse: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "connection_name": "list_expose_dev_dpulse"} */
alter session set quoted_identifiers_ignore_case = false;
[0m17:50:21.852390 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:22.217874 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.365 seconds
[0m17:50:22.225479 [debug] [ThreadPool]: Using snowflake connection "list_expose_dev_dpulse"
[0m17:50:22.226135 [debug] [ThreadPool]: On list_expose_dev_dpulse: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "connection_name": "list_expose_dev_dpulse"} */
show objects in expose_dev.dpulse
    limit 10000
    
;
[0m17:50:22.361979 [debug] [ThreadPool]: SQL status: SUCCESS 97 in 0.135 seconds
[0m17:50:22.367682 [debug] [ThreadPool]: Using snowflake connection "list_expose_dev_dpulse"
[0m17:50:22.368242 [debug] [ThreadPool]: On list_expose_dev_dpulse: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "connection_name": "list_expose_dev_dpulse"} */
alter session unset quoted_identifiers_ignore_case;
[0m17:50:22.444370 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.076 seconds
[0m17:50:22.462128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1465e9be-3706-4859-89a1-9c04b60ad750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B928AB7790>]}
[0m17:50:22.506103 [debug] [Thread-1 (]: Began running node model.GLOBAL_PERFMGT.crm_deal_quote_relevant
[0m17:50:22.506654 [info ] [Thread-1 (]: 1 of 1 START sql view model dpulse.crm_deal_quote_relevant ..................... [RUN]
[0m17:50:22.507422 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.GLOBAL_PERFMGT.crm_deal_quote_relevant'
[0m17:50:22.507732 [debug] [Thread-1 (]: Began compiling node model.GLOBAL_PERFMGT.crm_deal_quote_relevant
[0m17:50:22.512258 [debug] [Thread-1 (]: Writing injected SQL for node "model.GLOBAL_PERFMGT.crm_deal_quote_relevant"
[0m17:50:22.513673 [debug] [Thread-1 (]: Began executing node model.GLOBAL_PERFMGT.crm_deal_quote_relevant
[0m17:50:22.534336 [debug] [Thread-1 (]: Writing runtime sql for node "model.GLOBAL_PERFMGT.crm_deal_quote_relevant"
[0m17:50:22.537518 [debug] [Thread-1 (]: Using snowflake connection "model.GLOBAL_PERFMGT.crm_deal_quote_relevant"
[0m17:50:22.537920 [debug] [Thread-1 (]: On model.GLOBAL_PERFMGT.crm_deal_quote_relevant: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "node_id": "model.GLOBAL_PERFMGT.crm_deal_quote_relevant"} */
create or replace   view expose_dev.dpulse.crm_deal_quote_relevant
  
   as (
    

WITH LT_10 AS (
	SELECT 
		d.opportunityid, 
		d.id,
		q.quoteid,
		'10' fact_prog,
		q.name,
		q.createdon quote_createon,
		CASE WHEN MAX(q.createdon) OVER (PARTITION BY d.opportunityid) = q.createdon 
			THEN true 
			ELSE false 
		END filter,
		TO_CHAR(quote_createon,'YYYYMM') YM_START,
		NVL(TO_CHAR(datefinancialproposalagreed,'YYYYMM'),'999912') YM_END
		/*,progressiontech, datefinancialproposalagreed, datevalidated, datelegalagreement, d.createdon deal_createon, landlordsignaturedate, signaturedate,*/
	FROM finops.dwh.crm_deal d 
	LEFT JOIN finops.dwh.crm_quote q ON q.opportunityid = d.opportunityid
	WHERE --d.opportunityid='8602e810-0cb6-ee11-a569-000d3ab4b3e6' --'f1b05667-7d41-4bbc-9925-58e99d03ec9c' 
    --and 
    q.typecode ='809020000' --quote fin
    AND 
		(q.createdon< DATEADD(minute, 59, datefinancialproposalagreed ) 
		OR datefinancialproposalagreed IS NULL)
	QUALIFY filter = true
)
, LT_50 AS (
	SELECT 
		d.opportunityid, 
		d.id,
		q.quoteid,
		'50' fact_prog,
		q.name,
		q.createdon quote_createon,
		CASE WHEN min(q.createdon) OVER (PARTITION BY d.opportunityid) = q.createdon
			THEN true 
			ELSE false 
		END filter,
		TO_CHAR(quote_createon,'YYYYMM') YM_START,
		NVL(TO_CHAR(datevalidated,'YYYYMM'),'999912') YM_END
		/*,progressiontech, datefinancialproposalagreed, datevalidated, datelegalagreement, d.createdon deal_createon, landlordsignaturedate, signaturedate,*/
	FROM finops.dwh.crm_deal d 
	LEFT JOIN finops.dwh.crm_quote q ON q.opportunityid = d.opportunityid
	WHERE-- d.opportunityid='f1b05667-7d41-4bbc-9925-58e99d03ec9c'--'5b6b7053-7c73-4c7c-bd57-3fbf65bf46e9' AND
		(q.createdon< DATEADD(minute, 59, datevalidated)
		OR datevalidated IS NULL)
		AND progressiontech >= 50
		AND statereasoncode IN ('809020006','809020008') -- premiere quote valié
        and  q.typecode !='809020000' -- pas quote fin quote fin
	QUALIFY filter = true
)
, LT_70 AS (
	SELECT 
		d.opportunityid, 
		d.id,
		q.quoteid,
		'70' fact_prog,
		q.name,
		q.createdon quote_createon,
		CASE WHEN max(q.createdon) OVER (PARTITION BY d.opportunityid) = q.createdon 
			THEN true 
			ELSE false 
		END filter,
		TO_CHAR(quote_createon,'YYYYMM') YM_START,
		NVL(TO_CHAR(datelegalagreement,'YYYYMM'),'999912') YM_END
		/*,progressiontech, datefinancialproposalagreed, datevalidated, datelegalagreement, d.createdon deal_createon, landlordsignaturedate, signaturedate,*/
	FROM finops.dwh.crm_deal d 
	LEFT JOIN finops.dwh.crm_quote q ON q.opportunityid = d.opportunityid
	WHERE --d.opportunityid='f1b05667-7d41-4bbc-9925-58e99d03ec9c'--'5b6b7053-7c73-4c7c-bd57-3fbf65bf46e9' AND
		(q.createdon< DATEADD(minute, 59, datelegalagreement)
		OR datelegalagreement IS NULL)
		AND progressiontech >= 70
           and  q.typecode !='809020000' -- pas quote fin quote fin
	QUALIFY filter = true
)
, LT_90 AS (
	SELECT 
		d.opportunityid, 
		d.id,
		q.quoteid,
		'90' fact_prog,
		q.name,
		q.createdon quote_createon,
		CASE WHEN max(q.createdon) OVER (PARTITION BY d.opportunityid) = q.createdon 
			THEN true 
			ELSE false 
		END filter,
		TO_CHAR(quote_createon,'YYYYMM') YM_START,
		NVL(TO_CHAR(signaturedate,'YYYYMM'),'999912') YM_END
		/*,progressiontech, datefinancialproposalagreed, datevalidated, datelegalagreement, d.createdon deal_createon, landlordsignaturedate, signaturedate,*/
	FROM finops.dwh.crm_deal d 
	LEFT JOIN finops.dwh.crm_quote q ON q.opportunityid = d.opportunityid
	WHERE --d.opportunityid='11f976ee-4999-4f6c-beb9-12ee458a8df6'--'5b6b7053-7c73-4c7c-bd57-3fbf65bf46e9' AND 
		(q.createdon< DATEADD(minute, -1, signaturedate)
		OR signaturedate IS NULL)
		AND progressiontech >= 90
           and  q.typecode !='809020000' -- pas quote fin quote fin
	QUALIFY filter = true
)
, LT_100 AS (
	SELECT 
		d.opportunityid, 
		d.id,
		q.quoteid,
		'100' fact_prog,
		q.name,
		q.createdon quote_createon,
		true filter,
		TO_CHAR(quote_createon,'YYYYMM') YM_START,
		NVL(TO_CHAR(signaturedate,'YYYYMM'),'999912') YM_END
		/*,progressiontech, datefinancialproposalagreed, datevalidated, datelegalagreement, d.createdon deal_createon, landlordsignaturedate, signaturedate,*/
	FROM finops.dwh.crm_deal d 
	 left JOIN finops.dwh.crm_quote q ON q.opportunityid = d.opportunityid AND 
    d.quoteid = q.quoteid
	WHERE --d.opportunityid='6d4a9d80-bd0b-ef11-9f89-000d3abaebc4' AND
		progressiontech = 100
)
SELECT * exclude(filter)
FROM
(
	SELECT * FROM LT_10
	UNION ALL
	SELECT * FROM LT_50
	UNION ALL
	SELECT * FROM LT_70
	UNION ALL
	SELECT * FROM LT_90
	UNION ALL
	SELECT * FROM LT_100)
  );
[0m17:50:22.538268 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:50:23.873410 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.335 seconds
[0m17:50:23.912508 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1465e9be-3706-4859-89a1-9c04b60ad750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B928D859D0>]}
[0m17:50:23.913059 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dpulse.crm_deal_quote_relevant ................ [[32mSUCCESS 1[0m in 1.40s]
[0m17:50:23.913767 [debug] [Thread-1 (]: Finished running node model.GLOBAL_PERFMGT.crm_deal_quote_relevant
[0m17:50:23.924043 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:50:23.924389 [debug] [MainThread]: Connection 'list_expose_dev' was left open.
[0m17:50:23.924621 [debug] [MainThread]: On list_expose_dev: Close
[0m17:50:23.989624 [debug] [MainThread]: Connection 'list_expose_dev_dpulse' was left open.
[0m17:50:23.990432 [debug] [MainThread]: On list_expose_dev_dpulse: Close
[0m17:50:24.094231 [debug] [MainThread]: Connection 'model.GLOBAL_PERFMGT.crm_deal_quote_relevant' was left open.
[0m17:50:24.095350 [debug] [MainThread]: On model.GLOBAL_PERFMGT.crm_deal_quote_relevant: Close
[0m17:50:24.194186 [info ] [MainThread]: 
[0m17:50:24.195440 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.18 seconds (3.18s).
[0m17:50:24.197069 [debug] [MainThread]: Command end result
[0m17:50:24.224335 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\manifest.json
[0m17:50:24.227023 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\semantic_manifest.json
[0m17:50:24.231846 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\run_results.json
[0m17:50:24.232143 [info ] [MainThread]: 
[0m17:50:24.232976 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:50:24.233604 [info ] [MainThread]: 
[0m17:50:24.234016 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:50:24.235148 [debug] [MainThread]: Command `dbt run` succeeded at 17:50:24.234954 after 4.29 seconds
[0m17:50:24.235660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B928ADEC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B928CE84B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B928CEB890>]}
[0m17:50:24.236102 [debug] [MainThread]: Flushing usage events
[0m17:50:24.279036 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:53:59.763813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6CAEB3770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6CBBB6490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6CC0DFD90>]}


============================== 17:53:59.772173 | bd646f4f-0676-40bd-bc2e-e2cb53e5f125 ==============================
[0m17:53:59.772173 [info ] [MainThread]: Running with dbt=1.10.1
[0m17:53:59.773564 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alban.homo\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\alban.homo\\dev\\dperfmgt\\global_perfmgt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:54:00.116900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd646f4f-0676-40bd-bc2e-e2cb53e5f125', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6CB5BEFD0>]}
[0m17:54:00.159089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd646f4f-0676-40bd-bc2e-e2cb53e5f125', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6CE0958C0>]}
[0m17:54:00.160086 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m17:54:00.345326 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m17:54:00.506892 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:54:00.507242 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:54:00.510703 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.GLOBAL_PERFMGT.example
[0m17:54:00.524304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd646f4f-0676-40bd-bc2e-e2cb53e5f125', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6CE045E50>]}
[0m17:54:00.580689 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\manifest.json
[0m17:54:00.586124 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\semantic_manifest.json
[0m17:54:00.604092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd646f4f-0676-40bd-bc2e-e2cb53e5f125', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6CAEBBA70>]}
[0m17:54:00.604500 [info ] [MainThread]: Found 1 model, 476 macros
[0m17:54:00.605065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd646f4f-0676-40bd-bc2e-e2cb53e5f125', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6CE0CD010>]}
[0m17:54:00.606241 [info ] [MainThread]: 
[0m17:54:00.606712 [info ] [MainThread]: Concurrency: 200 threads (target='dev')
[0m17:54:00.607163 [info ] [MainThread]: 
[0m17:54:00.607679 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:54:00.608801 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_expose_dev'
[0m17:54:00.702549 [debug] [ThreadPool]: Using snowflake connection "list_expose_dev"
[0m17:54:00.702895 [debug] [ThreadPool]: On list_expose_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "connection_name": "list_expose_dev"} */
show terse schemas in database expose_dev
    limit 10000
[0m17:54:00.703121 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:01.179348 [debug] [ThreadPool]: SQL status: SUCCESS 54 in 0.476 seconds
[0m17:54:01.184580 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_expose_dev_dpulse'
[0m17:54:01.193446 [debug] [ThreadPool]: Using snowflake connection "list_expose_dev_dpulse"
[0m17:54:01.193822 [debug] [ThreadPool]: On list_expose_dev_dpulse: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "connection_name": "list_expose_dev_dpulse"} */
alter session set quoted_identifiers_ignore_case = false;
[0m17:54:01.194040 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:01.520189 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.326 seconds
[0m17:54:01.528279 [debug] [ThreadPool]: Using snowflake connection "list_expose_dev_dpulse"
[0m17:54:01.529238 [debug] [ThreadPool]: On list_expose_dev_dpulse: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "connection_name": "list_expose_dev_dpulse"} */
show objects in expose_dev.dpulse
    limit 10000
    
;
[0m17:54:01.669121 [debug] [ThreadPool]: SQL status: SUCCESS 97 in 0.139 seconds
[0m17:54:01.675065 [debug] [ThreadPool]: Using snowflake connection "list_expose_dev_dpulse"
[0m17:54:01.675727 [debug] [ThreadPool]: On list_expose_dev_dpulse: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "connection_name": "list_expose_dev_dpulse"} */
alter session unset quoted_identifiers_ignore_case;
[0m17:54:01.735645 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.059 seconds
[0m17:54:01.755381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd646f4f-0676-40bd-bc2e-e2cb53e5f125', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6CEA47790>]}
[0m17:54:01.791576 [debug] [Thread-1 (]: Began running node model.GLOBAL_PERFMGT.crm_deal_quote_relevant
[0m17:54:01.792213 [info ] [Thread-1 (]: 1 of 1 START sql view model dpulse.crm_deal_quote_relevant ..................... [RUN]
[0m17:54:01.792807 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.GLOBAL_PERFMGT.crm_deal_quote_relevant'
[0m17:54:01.793072 [debug] [Thread-1 (]: Began compiling node model.GLOBAL_PERFMGT.crm_deal_quote_relevant
[0m17:54:01.797531 [debug] [Thread-1 (]: Writing injected SQL for node "model.GLOBAL_PERFMGT.crm_deal_quote_relevant"
[0m17:54:01.798971 [debug] [Thread-1 (]: Began executing node model.GLOBAL_PERFMGT.crm_deal_quote_relevant
[0m17:54:01.818561 [debug] [Thread-1 (]: Writing runtime sql for node "model.GLOBAL_PERFMGT.crm_deal_quote_relevant"
[0m17:54:01.823142 [debug] [Thread-1 (]: Using snowflake connection "model.GLOBAL_PERFMGT.crm_deal_quote_relevant"
[0m17:54:01.823961 [debug] [Thread-1 (]: On model.GLOBAL_PERFMGT.crm_deal_quote_relevant: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "node_id": "model.GLOBAL_PERFMGT.crm_deal_quote_relevant"} */
create or replace   view expose_dev.dpulse.crm_deal_quote_relevant
  
   as (
    

WITH LT_10 AS (
	SELECT 
		d.opportunityid, 
		d.id,
		q.quoteid,
		'10' fact_prog,
		q.name,
		q.createdon quote_createon,
		CASE WHEN MAX(q.createdon) OVER (PARTITION BY d.opportunityid) = q.createdon 
			THEN true 
			ELSE false 
		END filter,
		TO_CHAR(quote_createon,'YYYYMM') YM_START,
		NVL(TO_CHAR(datefinancialproposalagreed,'YYYYMM'),'999912') YM_END
		/*,progressiontech, datefinancialproposalagreed, datevalidated, datelegalagreement, d.createdon deal_createon, landlordsignaturedate, signaturedate,*/
	FROM finops.dwh.crm_deal d 
	LEFT JOIN finops.dwh.crm_quote q ON q.opportunityid = d.opportunityid
	WHERE --d.opportunityid='8602e810-0cb6-ee11-a569-000d3ab4b3e6' --'f1b05667-7d41-4bbc-9925-58e99d03ec9c' 
    --and 
    q.typecode ='809020000' --quote fin
    AND 
		(q.createdon< DATEADD(minute, 59, datefinancialproposalagreed ) 
		OR datefinancialproposalagreed IS NULL)
	QUALIFY filter = true
)
, LT_50 AS (
	SELECT 
		d.opportunityid, 
		d.id,
		q.quoteid,
		'50' fact_prog,
		q.name,
		q.createdon quote_createon,
		CASE WHEN min(q.createdon) OVER (PARTITION BY d.opportunityid) = q.createdon
			THEN true 
			ELSE false 
		END filter,
		TO_CHAR(quote_createon,'YYYYMM') YM_START,
		NVL(TO_CHAR(datevalidated,'YYYYMM'),'999912') YM_END
		/*,progressiontech, datefinancialproposalagreed, datevalidated, datelegalagreement, d.createdon deal_createon, landlordsignaturedate, signaturedate,*/
	FROM finops.dwh.crm_deal d 
	LEFT JOIN finops.dwh.crm_quote q ON q.opportunityid = d.opportunityid
	WHERE-- d.opportunityid='f1b05667-7d41-4bbc-9925-58e99d03ec9c'--'5b6b7053-7c73-4c7c-bd57-3fbf65bf46e9' AND
		(q.createdon< DATEADD(minute, 59, datevalidated)
		OR datevalidated IS NULL)
		AND progressiontech >= 50
		AND statereasoncode IN ('809020006','809020008') -- premiere quote valié
        and  q.typecode !='809020000' -- pas quote fin quote fin
	QUALIFY filter = true
)
, LT_70 AS (
	SELECT 
		d.opportunityid, 
		d.id,
		q.quoteid,
		'70' fact_prog,
		q.name,
		q.createdon quote_createon,
		CASE WHEN max(q.createdon) OVER (PARTITION BY d.opportunityid) = q.createdon 
			THEN true 
			ELSE false 
		END filter,
		TO_CHAR(quote_createon,'YYYYMM') YM_START,
		NVL(TO_CHAR(datelegalagreement,'YYYYMM'),'999912') YM_END
		/*,progressiontech, datefinancialproposalagreed, datevalidated, datelegalagreement, d.createdon deal_createon, landlordsignaturedate, signaturedate,*/
	FROM finops.dwh.crm_deal d 
	LEFT JOIN finops.dwh.crm_quote q ON q.opportunityid = d.opportunityid
	WHERE --d.opportunityid='f1b05667-7d41-4bbc-9925-58e99d03ec9c'--'5b6b7053-7c73-4c7c-bd57-3fbf65bf46e9' AND
		(q.createdon< DATEADD(minute, 59, datelegalagreement)
		OR datelegalagreement IS NULL)
		AND progressiontech >= 70
           and  q.typecode !='809020000' -- pas quote fin quote fin
	QUALIFY filter = true
)
, LT_90 AS (
	SELECT 
		d.opportunityid, 
		d.id,
		q.quoteid,
		'90' fact_prog,
		q.name,
		q.createdon quote_createon,
		CASE WHEN max(q.createdon) OVER (PARTITION BY d.opportunityid) = q.createdon 
			THEN true 
			ELSE false 
		END filter,
		TO_CHAR(quote_createon,'YYYYMM') YM_START,
		NVL(TO_CHAR(signaturedate,'YYYYMM'),'999912') YM_END
		/*,progressiontech, datefinancialproposalagreed, datevalidated, datelegalagreement, d.createdon deal_createon, landlordsignaturedate, signaturedate,*/
	FROM finops.dwh.crm_deal d 
	LEFT JOIN finops.dwh.crm_quote q ON q.opportunityid = d.opportunityid
	WHERE --d.opportunityid='11f976ee-4999-4f6c-beb9-12ee458a8df6'--'5b6b7053-7c73-4c7c-bd57-3fbf65bf46e9' AND 
		(q.createdon< DATEADD(minute, -1, signaturedate)
		OR signaturedate IS NULL)
		AND progressiontech >= 90
           and  q.typecode !='809020000' -- pas quote fin quote fin
	QUALIFY filter = true
)
, LT_100 AS (
	SELECT 
		d.opportunityid, 
		d.id,
		q.quoteid,
		'100' fact_prog,
		q.name,
		q.createdon quote_createon,
		true filter,
		TO_CHAR(quote_createon,'YYYYMM') YM_START,
		NVL(TO_CHAR(signaturedate,'YYYYMM'),'999912') YM_END
		/*,progressiontech, datefinancialproposalagreed, datevalidated, datelegalagreement, d.createdon deal_createon, landlordsignaturedate, signaturedate,*/
	FROM finops.dwh.crm_deal d 
	 left JOIN finops.dwh.crm_quote q ON q.opportunityid = d.opportunityid AND 
    d.quoteid = q.quoteid
	WHERE --d.opportunityid='6d4a9d80-bd0b-ef11-9f89-000d3abaebc4' AND
		progressiontech = 100
)
SELECT * exclude(filter)
FROM
(
	SELECT * FROM LT_10
	UNION ALL
	SELECT * FROM LT_50
	UNION ALL
	SELECT * FROM LT_70
	UNION ALL
	SELECT * FROM LT_90
	UNION ALL
	SELECT * FROM LT_100)
  );
[0m17:54:01.824880 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:54:02.939442 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.115 seconds
[0m17:54:02.961460 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd646f4f-0676-40bd-bc2e-e2cb53e5f125', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6CED359D0>]}
[0m17:54:02.961962 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dpulse.crm_deal_quote_relevant ................ [[32mSUCCESS 1[0m in 1.17s]
[0m17:54:02.962772 [debug] [Thread-1 (]: Finished running node model.GLOBAL_PERFMGT.crm_deal_quote_relevant
[0m17:54:02.973515 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:54:02.973856 [debug] [MainThread]: Connection 'list_expose_dev' was left open.
[0m17:54:02.974071 [debug] [MainThread]: On list_expose_dev: Close
[0m17:54:03.052560 [debug] [MainThread]: Connection 'list_expose_dev_dpulse' was left open.
[0m17:54:03.053584 [debug] [MainThread]: On list_expose_dev_dpulse: Close
[0m17:54:03.119984 [debug] [MainThread]: Connection 'model.GLOBAL_PERFMGT.crm_deal_quote_relevant' was left open.
[0m17:54:03.121001 [debug] [MainThread]: On model.GLOBAL_PERFMGT.crm_deal_quote_relevant: Close
[0m17:54:03.222611 [info ] [MainThread]: 
[0m17:54:03.224102 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.61 seconds (2.61s).
[0m17:54:03.226025 [debug] [MainThread]: Command end result
[0m17:54:03.250079 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\manifest.json
[0m17:54:03.253336 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\semantic_manifest.json
[0m17:54:03.258401 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\run_results.json
[0m17:54:03.258731 [info ] [MainThread]: 
[0m17:54:03.259378 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:54:03.259869 [info ] [MainThread]: 
[0m17:54:03.260498 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:54:03.261336 [debug] [MainThread]: Command `dbt run` succeeded at 17:54:03.261229 after 3.80 seconds
[0m17:54:03.261622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6CEA8EC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6CEC984B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6CEC9B890>]}
[0m17:54:03.261885 [debug] [MainThread]: Flushing usage events
[0m17:54:03.578952 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:56:39.869987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F48C5D3770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F48D2E6490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F48D80FD90>]}


============================== 17:56:39.874040 | 124b68dc-f4f9-4336-b6d0-a4cd07a279ef ==============================
[0m17:56:39.874040 [info ] [MainThread]: Running with dbt=1.10.1
[0m17:56:39.875193 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\alban.homo\\.dbt', 'log_path': 'C:\\Users\\alban.homo\\dev\\dperfmgt\\global_perfmgt\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:56:40.227027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '124b68dc-f4f9-4336-b6d0-a4cd07a279ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F48CCEEFD0>]}
[0m17:56:40.269751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '124b68dc-f4f9-4336-b6d0-a4cd07a279ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F48F7758C0>]}
[0m17:56:40.270922 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m17:56:40.436737 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m17:56:40.583479 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:56:40.583798 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:56:40.604753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '124b68dc-f4f9-4336-b6d0-a4cd07a279ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F48F726350>]}
[0m17:56:40.646601 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\manifest.json
[0m17:56:40.650410 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\semantic_manifest.json
[0m17:56:40.668701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '124b68dc-f4f9-4336-b6d0-a4cd07a279ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F48C5DBA70>]}
[0m17:56:40.669128 [info ] [MainThread]: Found 1 model, 476 macros
[0m17:56:40.669682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '124b68dc-f4f9-4336-b6d0-a4cd07a279ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F48F81D1D0>]}
[0m17:56:40.670860 [info ] [MainThread]: 
[0m17:56:40.671413 [info ] [MainThread]: Concurrency: 200 threads (target='dev')
[0m17:56:40.671819 [info ] [MainThread]: 
[0m17:56:40.672460 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:56:40.673638 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_expose_dev'
[0m17:56:40.758429 [debug] [ThreadPool]: Using snowflake connection "list_expose_dev"
[0m17:56:40.758742 [debug] [ThreadPool]: On list_expose_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "connection_name": "list_expose_dev"} */
show terse schemas in database expose_dev
    limit 10000
[0m17:56:40.758942 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:56:41.270449 [debug] [ThreadPool]: SQL status: SUCCESS 54 in 0.511 seconds
[0m17:56:41.277071 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_expose_dev_dpulse'
[0m17:56:41.285406 [debug] [ThreadPool]: Using snowflake connection "list_expose_dev_dpulse"
[0m17:56:41.285777 [debug] [ThreadPool]: On list_expose_dev_dpulse: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "connection_name": "list_expose_dev_dpulse"} */
alter session set quoted_identifiers_ignore_case = false;
[0m17:56:41.286005 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:56:41.517230 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.231 seconds
[0m17:56:41.523453 [debug] [ThreadPool]: Using snowflake connection "list_expose_dev_dpulse"
[0m17:56:41.524092 [debug] [ThreadPool]: On list_expose_dev_dpulse: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "connection_name": "list_expose_dev_dpulse"} */
show objects in expose_dev.dpulse
    limit 10000
    
;
[0m17:56:41.619223 [debug] [ThreadPool]: SQL status: SUCCESS 97 in 0.095 seconds
[0m17:56:41.624019 [debug] [ThreadPool]: Using snowflake connection "list_expose_dev_dpulse"
[0m17:56:41.624563 [debug] [ThreadPool]: On list_expose_dev_dpulse: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "connection_name": "list_expose_dev_dpulse"} */
alter session unset quoted_identifiers_ignore_case;
[0m17:56:41.693792 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.069 seconds
[0m17:56:41.710471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '124b68dc-f4f9-4336-b6d0-a4cd07a279ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F490117790>]}
[0m17:56:41.739971 [debug] [Thread-1 (]: Began running node model.GLOBAL_PERFMGT.crm_deal_quote_relevant
[0m17:56:41.740494 [info ] [Thread-1 (]: 1 of 1 START sql view model dpulse.crm_deal_quote_relevant ..................... [RUN]
[0m17:56:41.741121 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.GLOBAL_PERFMGT.crm_deal_quote_relevant'
[0m17:56:41.741470 [debug] [Thread-1 (]: Began compiling node model.GLOBAL_PERFMGT.crm_deal_quote_relevant
[0m17:56:41.746048 [debug] [Thread-1 (]: Writing injected SQL for node "model.GLOBAL_PERFMGT.crm_deal_quote_relevant"
[0m17:56:41.747431 [debug] [Thread-1 (]: Began executing node model.GLOBAL_PERFMGT.crm_deal_quote_relevant
[0m17:56:41.766722 [debug] [Thread-1 (]: Writing runtime sql for node "model.GLOBAL_PERFMGT.crm_deal_quote_relevant"
[0m17:56:41.770782 [debug] [Thread-1 (]: Using snowflake connection "model.GLOBAL_PERFMGT.crm_deal_quote_relevant"
[0m17:56:41.771258 [debug] [Thread-1 (]: On model.GLOBAL_PERFMGT.crm_deal_quote_relevant: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "node_id": "model.GLOBAL_PERFMGT.crm_deal_quote_relevant"} */
create or replace   view expose_dev.dpulse.crm_deal_quote_relevant
  
   as (
    

WITH LT_10 AS (
	SELECT 
		d.opportunityid, 
		d.id,
		q.quoteid,
		'10' fact_prog,
		q.name,
		q.createdon quote_createon,
		CASE WHEN MAX(q.createdon) OVER (PARTITION BY d.opportunityid) = q.createdon 
			THEN true 
			ELSE false 
		END filter,
		TO_CHAR(quote_createon,'YYYYMM') YM_START,
		NVL(TO_CHAR(datefinancialproposalagreed,'YYYYMM'),'999912') YM_END
		/*,progressiontech, datefinancialproposalagreed, datevalidated, datelegalagreement, d.createdon deal_createon, landlordsignaturedate, signaturedate,*/
	FROM finops.dwh.crm_deal d 
	LEFT JOIN finops.dwh.crm_quote q ON q.opportunityid = d.opportunityid
	WHERE --d.opportunityid='8602e810-0cb6-ee11-a569-000d3ab4b3e6' --'f1b05667-7d41-4bbc-9925-58e99d03ec9c' 
    --and 
    q.typecode ='809020000' --quote fin
    AND 
		(q.createdon< DATEADD(minute, 59, datefinancialproposalagreed ) 
		OR datefinancialproposalagreed IS NULL)
	QUALIFY filter = true
)
, LT_50 AS (
	SELECT 
		d.opportunityid, 
		d.id,
		q.quoteid,
		'50' fact_prog,
		q.name,
		q.createdon quote_createon,
		CASE WHEN min(q.createdon) OVER (PARTITION BY d.opportunityid) = q.createdon
			THEN true 
			ELSE false 
		END filter,
		TO_CHAR(quote_createon,'YYYYMM') YM_START,
		NVL(TO_CHAR(datevalidated,'YYYYMM'),'999912') YM_END
		/*,progressiontech, datefinancialproposalagreed, datevalidated, datelegalagreement, d.createdon deal_createon, landlordsignaturedate, signaturedate,*/
	FROM finops.dwh.crm_deal d 
	LEFT JOIN finops.dwh.crm_quote q ON q.opportunityid = d.opportunityid
	WHERE-- d.opportunityid='f1b05667-7d41-4bbc-9925-58e99d03ec9c'--'5b6b7053-7c73-4c7c-bd57-3fbf65bf46e9' AND
		(q.createdon< DATEADD(minute, 59, datevalidated)
		OR datevalidated IS NULL)
		AND progressiontech >= 50
		AND statereasoncode IN ('809020006','809020008') -- premiere quote valié
        and  q.typecode !='809020000' -- pas quote fin quote fin
	QUALIFY filter = true
)
, LT_70 AS (
	SELECT 
		d.opportunityid, 
		d.id,
		q.quoteid,
		'70' fact_prog,
		q.name,
		q.createdon quote_createon,
		CASE WHEN max(q.createdon) OVER (PARTITION BY d.opportunityid) = q.createdon 
			THEN true 
			ELSE false 
		END filter,
		TO_CHAR(quote_createon,'YYYYMM') YM_START,
		NVL(TO_CHAR(datelegalagreement,'YYYYMM'),'999912') YM_END
		/*,progressiontech, datefinancialproposalagreed, datevalidated, datelegalagreement, d.createdon deal_createon, landlordsignaturedate, signaturedate,*/
	FROM finops.dwh.crm_deal d 
	LEFT JOIN finops.dwh.crm_quote q ON q.opportunityid = d.opportunityid
	WHERE --d.opportunityid='f1b05667-7d41-4bbc-9925-58e99d03ec9c'--'5b6b7053-7c73-4c7c-bd57-3fbf65bf46e9' AND
		(q.createdon< DATEADD(minute, 59, datelegalagreement)
		OR datelegalagreement IS NULL)
		AND progressiontech >= 70
           and  q.typecode !='809020000' -- pas quote fin quote fin
	QUALIFY filter = true
)
, LT_90 AS (
	SELECT 
		d.opportunityid, 
		d.id,
		q.quoteid,
		'90' fact_prog,
		q.name,
		q.createdon quote_createon,
		CASE WHEN max(q.createdon) OVER (PARTITION BY d.opportunityid) = q.createdon 
			THEN true 
			ELSE false 
		END filter,
		TO_CHAR(quote_createon,'YYYYMM') YM_START,
		NVL(TO_CHAR(signaturedate,'YYYYMM'),'999912') YM_END
		/*,progressiontech, datefinancialproposalagreed, datevalidated, datelegalagreement, d.createdon deal_createon, landlordsignaturedate, signaturedate,*/
	FROM finops.dwh.crm_deal d 
	LEFT JOIN finops.dwh.crm_quote q ON q.opportunityid = d.opportunityid
	WHERE --d.opportunityid='11f976ee-4999-4f6c-beb9-12ee458a8df6'--'5b6b7053-7c73-4c7c-bd57-3fbf65bf46e9' AND 
		(q.createdon< DATEADD(minute, -1, signaturedate)
		OR signaturedate IS NULL)
		AND progressiontech >= 90
           and  q.typecode !='809020000' -- pas quote fin quote fin
	QUALIFY filter = true
)
, LT_100 AS (
	SELECT 
		d.opportunityid, 
		d.id,
		q.quoteid,
		'100' fact_prog,
		q.name,
		q.createdon quote_createon,
		true filter,
		TO_CHAR(quote_createon,'YYYYMM') YM_START,
		NVL(TO_CHAR(signaturedate,'YYYYMM'),'999912') YM_END
		/*,progressiontech, datefinancialproposalagreed, datevalidated, datelegalagreement, d.createdon deal_createon, landlordsignaturedate, signaturedate,*/
	FROM finops.dwh.crm_deal d 
	 left JOIN finops.dwh.crm_quote q ON q.opportunityid = d.opportunityid AND 
    d.quoteid = q.quoteid
	WHERE --d.opportunityid='6d4a9d80-bd0b-ef11-9f89-000d3abaebc4' AND
		progressiontech = 100
)
SELECT * exclude(filter)
FROM
(
	SELECT * FROM LT_10
	UNION ALL
	SELECT * FROM LT_50
	UNION ALL
	SELECT * FROM LT_70
	UNION ALL
	SELECT * FROM LT_90
	UNION ALL
	SELECT * FROM LT_100)
  );
[0m17:56:41.771624 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:56:42.825477 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.054 seconds
[0m17:56:42.845465 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '124b68dc-f4f9-4336-b6d0-a4cd07a279ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4904059D0>]}
[0m17:56:42.846004 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dpulse.crm_deal_quote_relevant ................ [[32mSUCCESS 1[0m in 1.10s]
[0m17:56:42.846784 [debug] [Thread-1 (]: Finished running node model.GLOBAL_PERFMGT.crm_deal_quote_relevant
[0m17:56:42.858869 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:56:42.859304 [debug] [MainThread]: Connection 'list_expose_dev' was left open.
[0m17:56:42.859534 [debug] [MainThread]: On list_expose_dev: Close
[0m17:56:42.933410 [debug] [MainThread]: Connection 'list_expose_dev_dpulse' was left open.
[0m17:56:42.934288 [debug] [MainThread]: On list_expose_dev_dpulse: Close
[0m17:56:43.004379 [debug] [MainThread]: Connection 'model.GLOBAL_PERFMGT.crm_deal_quote_relevant' was left open.
[0m17:56:43.005404 [debug] [MainThread]: On model.GLOBAL_PERFMGT.crm_deal_quote_relevant: Close
[0m17:56:43.087720 [info ] [MainThread]: 
[0m17:56:43.088941 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.42 seconds (2.42s).
[0m17:56:43.089878 [debug] [MainThread]: Command end result
[0m17:56:43.117761 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\manifest.json
[0m17:56:43.120469 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\semantic_manifest.json
[0m17:56:43.127794 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\run_results.json
[0m17:56:43.128267 [info ] [MainThread]: 
[0m17:56:43.129006 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:56:43.129557 [info ] [MainThread]: 
[0m17:56:43.130047 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:56:43.130825 [debug] [MainThread]: Command `dbt run` succeeded at 17:56:43.130733 after 3.52 seconds
[0m17:56:43.131100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F490166C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F49040D130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F49040CE10>]}
[0m17:56:43.131418 [debug] [MainThread]: Flushing usage events
[0m17:56:43.437462 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:57:58.405678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F431E23770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F432B36490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F43305FD90>]}


============================== 17:57:58.409828 | 4d246a42-441d-4169-8d94-a1f92058d4f0 ==============================
[0m17:57:58.409828 [info ] [MainThread]: Running with dbt=1.10.1
[0m17:57:58.411279 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alban.homo\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\alban.homo\\dev\\dperfmgt\\global_perfmgt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:57:58.755527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d246a42-441d-4169-8d94-a1f92058d4f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F43253AFD0>]}
[0m17:57:58.795825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d246a42-441d-4169-8d94-a1f92058d4f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F434FE58C0>]}
[0m17:57:58.796930 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m17:57:58.969726 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m17:57:59.132041 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:57:59.132411 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:57:59.148417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d246a42-441d-4169-8d94-a1f92058d4f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F434F95E50>]}
[0m17:57:59.205266 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\manifest.json
[0m17:57:59.209862 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\semantic_manifest.json
[0m17:57:59.228654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d246a42-441d-4169-8d94-a1f92058d4f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F431E2BA70>]}
[0m17:57:59.229125 [info ] [MainThread]: Found 1 model, 476 macros
[0m17:57:59.229777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d246a42-441d-4169-8d94-a1f92058d4f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F435015010>]}
[0m17:57:59.231019 [info ] [MainThread]: 
[0m17:57:59.231700 [info ] [MainThread]: Concurrency: 200 threads (target='dev')
[0m17:57:59.232157 [info ] [MainThread]: 
[0m17:57:59.232885 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:57:59.234194 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_expose_dev'
[0m17:57:59.321499 [debug] [ThreadPool]: Using snowflake connection "list_expose_dev"
[0m17:57:59.321803 [debug] [ThreadPool]: On list_expose_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "connection_name": "list_expose_dev"} */
show terse schemas in database expose_dev
    limit 10000
[0m17:57:59.322006 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:57:59.824019 [debug] [ThreadPool]: SQL status: SUCCESS 54 in 0.502 seconds
[0m17:57:59.829989 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_expose_dev_dpulse'
[0m17:57:59.841756 [debug] [ThreadPool]: Using snowflake connection "list_expose_dev_dpulse"
[0m17:57:59.842051 [debug] [ThreadPool]: On list_expose_dev_dpulse: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "connection_name": "list_expose_dev_dpulse"} */
alter session set quoted_identifiers_ignore_case = false;
[0m17:57:59.842247 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:58:00.155930 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.314 seconds
[0m17:58:00.160146 [debug] [ThreadPool]: Using snowflake connection "list_expose_dev_dpulse"
[0m17:58:00.160599 [debug] [ThreadPool]: On list_expose_dev_dpulse: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "connection_name": "list_expose_dev_dpulse"} */
show objects in expose_dev.dpulse
    limit 10000
    
;
[0m17:58:00.283028 [debug] [ThreadPool]: SQL status: SUCCESS 97 in 0.122 seconds
[0m17:58:00.287966 [debug] [ThreadPool]: Using snowflake connection "list_expose_dev_dpulse"
[0m17:58:00.288522 [debug] [ThreadPool]: On list_expose_dev_dpulse: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "connection_name": "list_expose_dev_dpulse"} */
alter session unset quoted_identifiers_ignore_case;
[0m17:58:00.364514 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.076 seconds
[0m17:58:00.379267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d246a42-441d-4169-8d94-a1f92058d4f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F435997790>]}
[0m17:58:00.421300 [debug] [Thread-1 (]: Began running node model.GLOBAL_PERFMGT.crm_deal_quote_relevant
[0m17:58:00.421816 [info ] [Thread-1 (]: 1 of 1 START sql table model dpulse.crm_deal_quote_relevant .................... [RUN]
[0m17:58:00.422499 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.GLOBAL_PERFMGT.crm_deal_quote_relevant'
[0m17:58:00.422793 [debug] [Thread-1 (]: Began compiling node model.GLOBAL_PERFMGT.crm_deal_quote_relevant
[0m17:58:00.427518 [debug] [Thread-1 (]: Writing injected SQL for node "model.GLOBAL_PERFMGT.crm_deal_quote_relevant"
[0m17:58:00.428939 [debug] [Thread-1 (]: Began executing node model.GLOBAL_PERFMGT.crm_deal_quote_relevant
[0m17:58:00.440147 [debug] [Thread-1 (]:  adapter: Dropping relation "EXPOSE_DEV"."DPULSE"."CRM_DEAL_QUOTE_RELEVANT" because it is a view and target relation expose_dev.dpulse.crm_deal_quote_relevant is of type table.
[0m17:58:00.447232 [debug] [Thread-1 (]: Applying DROP to: "EXPOSE_DEV"."DPULSE"."CRM_DEAL_QUOTE_RELEVANT"
[0m17:58:00.451558 [debug] [Thread-1 (]: Using snowflake connection "model.GLOBAL_PERFMGT.crm_deal_quote_relevant"
[0m17:58:00.451859 [debug] [Thread-1 (]: On model.GLOBAL_PERFMGT.crm_deal_quote_relevant: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "node_id": "model.GLOBAL_PERFMGT.crm_deal_quote_relevant"} */
drop view if exists "EXPOSE_DEV"."DPULSE"."CRM_DEAL_QUOTE_RELEVANT" cascade
[0m17:58:00.452091 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:58:00.821064 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.369 seconds
[0m17:58:00.838229 [debug] [Thread-1 (]: Writing runtime sql for node "model.GLOBAL_PERFMGT.crm_deal_quote_relevant"
[0m17:58:00.842354 [debug] [Thread-1 (]: Using snowflake connection "model.GLOBAL_PERFMGT.crm_deal_quote_relevant"
[0m17:58:00.842815 [debug] [Thread-1 (]: On model.GLOBAL_PERFMGT.crm_deal_quote_relevant: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "node_id": "model.GLOBAL_PERFMGT.crm_deal_quote_relevant"} */
create or replace transient table expose_dev.dpulse.crm_deal_quote_relevant
    

    
    as (

WITH LT_10 AS (
	SELECT 
		d.opportunityid, 
		d.id,
		q.quoteid,
		'10' fact_prog,
		q.name,
		q.createdon quote_createon,
		CASE WHEN MAX(q.createdon) OVER (PARTITION BY d.opportunityid) = q.createdon 
			THEN true 
			ELSE false 
		END filter,
		TO_CHAR(quote_createon,'YYYYMM') YM_START,
		NVL(TO_CHAR(datefinancialproposalagreed,'YYYYMM'),'999912') YM_END
		/*,progressiontech, datefinancialproposalagreed, datevalidated, datelegalagreement, d.createdon deal_createon, landlordsignaturedate, signaturedate,*/
	FROM finops.dwh.crm_deal d 
	LEFT JOIN finops.dwh.crm_quote q ON q.opportunityid = d.opportunityid
	WHERE --d.opportunityid='8602e810-0cb6-ee11-a569-000d3ab4b3e6' --'f1b05667-7d41-4bbc-9925-58e99d03ec9c' 
    --and 
    q.typecode ='809020000' --quote fin
    AND 
		(q.createdon< DATEADD(minute, 59, datefinancialproposalagreed ) 
		OR datefinancialproposalagreed IS NULL)
	QUALIFY filter = true
)
, LT_50 AS (
	SELECT 
		d.opportunityid, 
		d.id,
		q.quoteid,
		'50' fact_prog,
		q.name,
		q.createdon quote_createon,
		CASE WHEN min(q.createdon) OVER (PARTITION BY d.opportunityid) = q.createdon
			THEN true 
			ELSE false 
		END filter,
		TO_CHAR(quote_createon,'YYYYMM') YM_START,
		NVL(TO_CHAR(datevalidated,'YYYYMM'),'999912') YM_END
		/*,progressiontech, datefinancialproposalagreed, datevalidated, datelegalagreement, d.createdon deal_createon, landlordsignaturedate, signaturedate,*/
	FROM finops.dwh.crm_deal d 
	LEFT JOIN finops.dwh.crm_quote q ON q.opportunityid = d.opportunityid
	WHERE-- d.opportunityid='f1b05667-7d41-4bbc-9925-58e99d03ec9c'--'5b6b7053-7c73-4c7c-bd57-3fbf65bf46e9' AND
		(q.createdon< DATEADD(minute, 59, datevalidated)
		OR datevalidated IS NULL)
		AND progressiontech >= 50
		AND statereasoncode IN ('809020006','809020008') -- premiere quote valié
        and  q.typecode !='809020000' -- pas quote fin quote fin
	QUALIFY filter = true
)
, LT_70 AS (
	SELECT 
		d.opportunityid, 
		d.id,
		q.quoteid,
		'70' fact_prog,
		q.name,
		q.createdon quote_createon,
		CASE WHEN max(q.createdon) OVER (PARTITION BY d.opportunityid) = q.createdon 
			THEN true 
			ELSE false 
		END filter,
		TO_CHAR(quote_createon,'YYYYMM') YM_START,
		NVL(TO_CHAR(datelegalagreement,'YYYYMM'),'999912') YM_END
		/*,progressiontech, datefinancialproposalagreed, datevalidated, datelegalagreement, d.createdon deal_createon, landlordsignaturedate, signaturedate,*/
	FROM finops.dwh.crm_deal d 
	LEFT JOIN finops.dwh.crm_quote q ON q.opportunityid = d.opportunityid
	WHERE --d.opportunityid='f1b05667-7d41-4bbc-9925-58e99d03ec9c'--'5b6b7053-7c73-4c7c-bd57-3fbf65bf46e9' AND
		(q.createdon< DATEADD(minute, 59, datelegalagreement)
		OR datelegalagreement IS NULL)
		AND progressiontech >= 70
           and  q.typecode !='809020000' -- pas quote fin quote fin
	QUALIFY filter = true
)
, LT_90 AS (
	SELECT 
		d.opportunityid, 
		d.id,
		q.quoteid,
		'90' fact_prog,
		q.name,
		q.createdon quote_createon,
		CASE WHEN max(q.createdon) OVER (PARTITION BY d.opportunityid) = q.createdon 
			THEN true 
			ELSE false 
		END filter,
		TO_CHAR(quote_createon,'YYYYMM') YM_START,
		NVL(TO_CHAR(signaturedate,'YYYYMM'),'999912') YM_END
		/*,progressiontech, datefinancialproposalagreed, datevalidated, datelegalagreement, d.createdon deal_createon, landlordsignaturedate, signaturedate,*/
	FROM finops.dwh.crm_deal d 
	LEFT JOIN finops.dwh.crm_quote q ON q.opportunityid = d.opportunityid
	WHERE --d.opportunityid='11f976ee-4999-4f6c-beb9-12ee458a8df6'--'5b6b7053-7c73-4c7c-bd57-3fbf65bf46e9' AND 
		(q.createdon< DATEADD(minute, -1, signaturedate)
		OR signaturedate IS NULL)
		AND progressiontech >= 90
           and  q.typecode !='809020000' -- pas quote fin quote fin
	QUALIFY filter = true
)
, LT_100 AS (
	SELECT 
		d.opportunityid, 
		d.id,
		q.quoteid,
		'100' fact_prog,
		q.name,
		q.createdon quote_createon,
		true filter,
		TO_CHAR(quote_createon,'YYYYMM') YM_START,
		NVL(TO_CHAR(signaturedate,'YYYYMM'),'999912') YM_END
		/*,progressiontech, datefinancialproposalagreed, datevalidated, datelegalagreement, d.createdon deal_createon, landlordsignaturedate, signaturedate,*/
	FROM finops.dwh.crm_deal d 
	 left JOIN finops.dwh.crm_quote q ON q.opportunityid = d.opportunityid AND 
    d.quoteid = q.quoteid
	WHERE --d.opportunityid='6d4a9d80-bd0b-ef11-9f89-000d3abaebc4' AND
		progressiontech = 100
)
SELECT * exclude(filter)
FROM
(
	SELECT * FROM LT_10
	UNION ALL
	SELECT * FROM LT_50
	UNION ALL
	SELECT * FROM LT_70
	UNION ALL
	SELECT * FROM LT_90
	UNION ALL
	SELECT * FROM LT_100)
    )
;
[0m17:58:09.963296 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 9.120 seconds
[0m17:58:10.028405 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d246a42-441d-4169-8d94-a1f92058d4f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F435C81790>]}
[0m17:58:10.029628 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dpulse.crm_deal_quote_relevant ............... [[32mSUCCESS 1[0m in 9.60s]
[0m17:58:10.030972 [debug] [Thread-1 (]: Finished running node model.GLOBAL_PERFMGT.crm_deal_quote_relevant
[0m17:58:10.042142 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:58:10.042806 [debug] [MainThread]: Connection 'list_expose_dev' was left open.
[0m17:58:10.043096 [debug] [MainThread]: On list_expose_dev: Close
[0m17:58:10.111385 [debug] [MainThread]: Connection 'list_expose_dev_dpulse' was left open.
[0m17:58:10.111799 [debug] [MainThread]: On list_expose_dev_dpulse: Close
[0m17:58:10.183963 [debug] [MainThread]: Connection 'model.GLOBAL_PERFMGT.crm_deal_quote_relevant' was left open.
[0m17:58:10.184379 [debug] [MainThread]: On model.GLOBAL_PERFMGT.crm_deal_quote_relevant: Close
[0m17:58:10.255544 [info ] [MainThread]: 
[0m17:58:10.256883 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.02 seconds (11.02s).
[0m17:58:10.258339 [debug] [MainThread]: Command end result
[0m17:58:10.279482 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\manifest.json
[0m17:58:10.282900 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\semantic_manifest.json
[0m17:58:10.287985 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\run_results.json
[0m17:58:10.288313 [info ] [MainThread]: 
[0m17:58:10.289077 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:58:10.289861 [info ] [MainThread]: 
[0m17:58:10.290494 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:58:10.291212 [debug] [MainThread]: Command `dbt run` succeeded at 17:58:10.291121 after 12.15 seconds
[0m17:58:10.291488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4359DFD80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4350AF6B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F435BE5D10>]}
[0m17:58:10.291768 [debug] [MainThread]: Flushing usage events
[0m17:58:10.625515 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:59:13.390117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023748F73770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023749C76490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002374A19FD90>]}


============================== 17:59:13.395716 | 33d912b0-2f56-4003-b932-0d9943271d08 ==============================
[0m17:59:13.395716 [info ] [MainThread]: Running with dbt=1.10.1
[0m17:59:13.396701 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\alban.homo\\dev\\dperfmgt\\global_perfmgt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\alban.homo\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:59:13.755750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33d912b0-2f56-4003-b932-0d9943271d08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002374967AFD0>]}
[0m17:59:13.795682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33d912b0-2f56-4003-b932-0d9943271d08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002374C0A58C0>]}
[0m17:59:13.796647 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m17:59:13.968953 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m17:59:14.130787 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:59:14.131178 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:59:14.147741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33d912b0-2f56-4003-b932-0d9943271d08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002374C055E50>]}
[0m17:59:14.204206 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\manifest.json
[0m17:59:14.208049 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\semantic_manifest.json
[0m17:59:14.225803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33d912b0-2f56-4003-b932-0d9943271d08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023748F7BA70>]}
[0m17:59:14.226222 [info ] [MainThread]: Found 1 model, 476 macros
[0m17:59:14.226705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33d912b0-2f56-4003-b932-0d9943271d08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002374C0D5010>]}
[0m17:59:14.227915 [info ] [MainThread]: 
[0m17:59:14.228416 [info ] [MainThread]: Concurrency: 200 threads (target='dev')
[0m17:59:14.228759 [info ] [MainThread]: 
[0m17:59:14.229238 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:59:14.230637 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_expose_dev'
[0m17:59:14.318434 [debug] [ThreadPool]: Using snowflake connection "list_expose_dev"
[0m17:59:14.318768 [debug] [ThreadPool]: On list_expose_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "connection_name": "list_expose_dev"} */
show terse schemas in database expose_dev
    limit 10000
[0m17:59:14.319032 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:59:15.015845 [debug] [ThreadPool]: SQL status: SUCCESS 54 in 0.697 seconds
[0m17:59:15.019375 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_expose_dev_dpulse'
[0m17:59:15.025979 [debug] [ThreadPool]: Using snowflake connection "list_expose_dev_dpulse"
[0m17:59:15.026321 [debug] [ThreadPool]: On list_expose_dev_dpulse: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "connection_name": "list_expose_dev_dpulse"} */
alter session set quoted_identifiers_ignore_case = false;
[0m17:59:15.026527 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:59:15.308195 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.281 seconds
[0m17:59:15.315385 [debug] [ThreadPool]: Using snowflake connection "list_expose_dev_dpulse"
[0m17:59:15.316462 [debug] [ThreadPool]: On list_expose_dev_dpulse: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "connection_name": "list_expose_dev_dpulse"} */
show objects in expose_dev.dpulse
    limit 10000
    
;
[0m17:59:15.456011 [debug] [ThreadPool]: SQL status: SUCCESS 97 in 0.139 seconds
[0m17:59:15.458869 [debug] [ThreadPool]: Using snowflake connection "list_expose_dev_dpulse"
[0m17:59:15.459094 [debug] [ThreadPool]: On list_expose_dev_dpulse: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "connection_name": "list_expose_dev_dpulse"} */
alter session unset quoted_identifiers_ignore_case;
[0m17:59:15.575284 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.116 seconds
[0m17:59:15.596130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33d912b0-2f56-4003-b932-0d9943271d08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002374CA57790>]}
[0m17:59:15.645854 [debug] [Thread-1 (]: Began running node model.GLOBAL_PERFMGT.crm_deal_quote_relevant
[0m17:59:15.646364 [info ] [Thread-1 (]: 1 of 1 START sql view model dpulse.crm_deal_quote_relevant ..................... [RUN]
[0m17:59:15.647051 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.GLOBAL_PERFMGT.crm_deal_quote_relevant'
[0m17:59:15.647314 [debug] [Thread-1 (]: Began compiling node model.GLOBAL_PERFMGT.crm_deal_quote_relevant
[0m17:59:15.652045 [debug] [Thread-1 (]: Writing injected SQL for node "model.GLOBAL_PERFMGT.crm_deal_quote_relevant"
[0m17:59:15.653744 [debug] [Thread-1 (]: Began executing node model.GLOBAL_PERFMGT.crm_deal_quote_relevant
[0m17:59:15.669236 [debug] [Thread-1 (]: Dropping relation "EXPOSE_DEV"."DPULSE"."CRM_DEAL_QUOTE_RELEVANT" because it is of type table
[0m17:59:15.675408 [debug] [Thread-1 (]: Applying DROP to: "EXPOSE_DEV"."DPULSE"."CRM_DEAL_QUOTE_RELEVANT"
[0m17:59:15.679647 [debug] [Thread-1 (]: Using snowflake connection "model.GLOBAL_PERFMGT.crm_deal_quote_relevant"
[0m17:59:15.679984 [debug] [Thread-1 (]: On model.GLOBAL_PERFMGT.crm_deal_quote_relevant: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "node_id": "model.GLOBAL_PERFMGT.crm_deal_quote_relevant"} */
drop table if exists "EXPOSE_DEV"."DPULSE"."CRM_DEAL_QUOTE_RELEVANT" cascade
[0m17:59:15.680216 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:59:16.009657 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.329 seconds
[0m17:59:16.024358 [debug] [Thread-1 (]: Writing runtime sql for node "model.GLOBAL_PERFMGT.crm_deal_quote_relevant"
[0m17:59:16.027329 [debug] [Thread-1 (]: Using snowflake connection "model.GLOBAL_PERFMGT.crm_deal_quote_relevant"
[0m17:59:16.027710 [debug] [Thread-1 (]: On model.GLOBAL_PERFMGT.crm_deal_quote_relevant: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "node_id": "model.GLOBAL_PERFMGT.crm_deal_quote_relevant"} */
create or replace   view expose_dev.dpulse.crm_deal_quote_relevant
  
   as (
    

WITH LT_10 AS (
	SELECT 
		d.opportunityid, 
		d.id,
		q.quoteid,
		'10' fact_prog,
		q.name,
		q.createdon quote_createon,
		CASE WHEN MAX(q.createdon) OVER (PARTITION BY d.opportunityid) = q.createdon 
			THEN true 
			ELSE false 
		END filter,
		TO_CHAR(quote_createon,'YYYYMM') YM_START,
		NVL(TO_CHAR(datefinancialproposalagreed,'YYYYMM'),'999912') YM_END
		/*,progressiontech, datefinancialproposalagreed, datevalidated, datelegalagreement, d.createdon deal_createon, landlordsignaturedate, signaturedate,*/
	FROM finops.dwh.crm_deal d 
	LEFT JOIN finops.dwh.crm_quote q ON q.opportunityid = d.opportunityid
	WHERE --d.opportunityid='8602e810-0cb6-ee11-a569-000d3ab4b3e6' --'f1b05667-7d41-4bbc-9925-58e99d03ec9c' 
    --and 
    q.typecode ='809020000' --quote fin
    AND 
		(q.createdon< DATEADD(minute, 59, datefinancialproposalagreed ) 
		OR datefinancialproposalagreed IS NULL)
	QUALIFY filter = true
)
, LT_50 AS (
	SELECT 
		d.opportunityid, 
		d.id,
		q.quoteid,
		'50' fact_prog,
		q.name,
		q.createdon quote_createon,
		CASE WHEN min(q.createdon) OVER (PARTITION BY d.opportunityid) = q.createdon
			THEN true 
			ELSE false 
		END filter,
		TO_CHAR(quote_createon,'YYYYMM') YM_START,
		NVL(TO_CHAR(datevalidated,'YYYYMM'),'999912') YM_END
		/*,progressiontech, datefinancialproposalagreed, datevalidated, datelegalagreement, d.createdon deal_createon, landlordsignaturedate, signaturedate,*/
	FROM finops.dwh.crm_deal d 
	LEFT JOIN finops.dwh.crm_quote q ON q.opportunityid = d.opportunityid
	WHERE-- d.opportunityid='f1b05667-7d41-4bbc-9925-58e99d03ec9c'--'5b6b7053-7c73-4c7c-bd57-3fbf65bf46e9' AND
		(q.createdon< DATEADD(minute, 59, datevalidated)
		OR datevalidated IS NULL)
		AND progressiontech >= 50
		AND statereasoncode IN ('809020006','809020008') -- premiere quote valié
        and  q.typecode !='809020000' -- pas quote fin quote fin
	QUALIFY filter = true
)
, LT_70 AS (
	SELECT 
		d.opportunityid, 
		d.id,
		q.quoteid,
		'70' fact_prog,
		q.name,
		q.createdon quote_createon,
		CASE WHEN max(q.createdon) OVER (PARTITION BY d.opportunityid) = q.createdon 
			THEN true 
			ELSE false 
		END filter,
		TO_CHAR(quote_createon,'YYYYMM') YM_START,
		NVL(TO_CHAR(datelegalagreement,'YYYYMM'),'999912') YM_END
		/*,progressiontech, datefinancialproposalagreed, datevalidated, datelegalagreement, d.createdon deal_createon, landlordsignaturedate, signaturedate,*/
	FROM finops.dwh.crm_deal d 
	LEFT JOIN finops.dwh.crm_quote q ON q.opportunityid = d.opportunityid
	WHERE --d.opportunityid='f1b05667-7d41-4bbc-9925-58e99d03ec9c'--'5b6b7053-7c73-4c7c-bd57-3fbf65bf46e9' AND
		(q.createdon< DATEADD(minute, 59, datelegalagreement)
		OR datelegalagreement IS NULL)
		AND progressiontech >= 70
           and  q.typecode !='809020000' -- pas quote fin quote fin
	QUALIFY filter = true
)
, LT_90 AS (
	SELECT 
		d.opportunityid, 
		d.id,
		q.quoteid,
		'90' fact_prog,
		q.name,
		q.createdon quote_createon,
		CASE WHEN max(q.createdon) OVER (PARTITION BY d.opportunityid) = q.createdon 
			THEN true 
			ELSE false 
		END filter,
		TO_CHAR(quote_createon,'YYYYMM') YM_START,
		NVL(TO_CHAR(signaturedate,'YYYYMM'),'999912') YM_END
		/*,progressiontech, datefinancialproposalagreed, datevalidated, datelegalagreement, d.createdon deal_createon, landlordsignaturedate, signaturedate,*/
	FROM finops.dwh.crm_deal d 
	LEFT JOIN finops.dwh.crm_quote q ON q.opportunityid = d.opportunityid
	WHERE --d.opportunityid='11f976ee-4999-4f6c-beb9-12ee458a8df6'--'5b6b7053-7c73-4c7c-bd57-3fbf65bf46e9' AND 
		(q.createdon< DATEADD(minute, -1, signaturedate)
		OR signaturedate IS NULL)
		AND progressiontech >= 90
           and  q.typecode !='809020000' -- pas quote fin quote fin
	QUALIFY filter = true
)
, LT_100 AS (
	SELECT 
		d.opportunityid, 
		d.id,
		q.quoteid,
		'100' fact_prog,
		q.name,
		q.createdon quote_createon,
		true filter,
		TO_CHAR(quote_createon,'YYYYMM') YM_START,
		NVL(TO_CHAR(signaturedate,'YYYYMM'),'999912') YM_END
		/*,progressiontech, datefinancialproposalagreed, datevalidated, datelegalagreement, d.createdon deal_createon, landlordsignaturedate, signaturedate,*/
	FROM finops.dwh.crm_deal d 
	 left JOIN finops.dwh.crm_quote q ON q.opportunityid = d.opportunityid AND 
    d.quoteid = q.quoteid
	WHERE --d.opportunityid='6d4a9d80-bd0b-ef11-9f89-000d3abaebc4' AND
		progressiontech = 100
)
SELECT * exclude(filter)
FROM
(
	SELECT * FROM LT_10
	UNION ALL
	SELECT * FROM LT_50
	UNION ALL
	SELECT * FROM LT_70
	UNION ALL
	SELECT * FROM LT_90
	UNION ALL
	SELECT * FROM LT_100)
  );
[0m17:59:17.094598 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.066 seconds
[0m17:59:17.118441 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33d912b0-2f56-4003-b932-0d9943271d08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002374CD419D0>]}
[0m17:59:17.118975 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dpulse.crm_deal_quote_relevant ................ [[32mSUCCESS 1[0m in 1.47s]
[0m17:59:17.119693 [debug] [Thread-1 (]: Finished running node model.GLOBAL_PERFMGT.crm_deal_quote_relevant
[0m17:59:17.129462 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:59:17.129770 [debug] [MainThread]: Connection 'list_expose_dev' was left open.
[0m17:59:17.129974 [debug] [MainThread]: On list_expose_dev: Close
[0m17:59:17.230755 [debug] [MainThread]: Connection 'list_expose_dev_dpulse' was left open.
[0m17:59:17.231480 [debug] [MainThread]: On list_expose_dev_dpulse: Close
[0m17:59:17.371914 [debug] [MainThread]: Connection 'model.GLOBAL_PERFMGT.crm_deal_quote_relevant' was left open.
[0m17:59:17.372875 [debug] [MainThread]: On model.GLOBAL_PERFMGT.crm_deal_quote_relevant: Close
[0m17:59:17.447705 [info ] [MainThread]: 
[0m17:59:17.450731 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.22 seconds (3.22s).
[0m17:59:17.453886 [debug] [MainThread]: Command end result
[0m17:59:17.475107 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\manifest.json
[0m17:59:17.477520 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\semantic_manifest.json
[0m17:59:17.482568 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\run_results.json
[0m17:59:17.482853 [info ] [MainThread]: 
[0m17:59:17.483968 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:59:17.484419 [info ] [MainThread]: 
[0m17:59:17.484843 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:59:17.485520 [debug] [MainThread]: Command `dbt run` succeeded at 17:59:17.485432 after 4.37 seconds
[0m17:59:17.485796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002374CA9F8B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002374C16F6B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002374CCA5D10>]}
[0m17:59:17.486051 [debug] [MainThread]: Flushing usage events
[0m17:59:17.822220 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:10:17.194907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7E8AE3770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7E97E6490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7E9D0FD90>]}


============================== 18:10:17.198728 | e6bbf323-0bf0-4d7c-ba45-d010beed5190 ==============================
[0m18:10:17.198728 [info ] [MainThread]: Running with dbt=1.10.1
[0m18:10:17.199688 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\alban.homo\\dev\\dperfmgt\\global_perfmgt\\logs', 'profiles_dir': 'C:\\Users\\alban.homo\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:10:17.591700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6bbf323-0bf0-4d7c-ba45-d010beed5190', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7E91E6FD0>]}
[0m18:10:17.632444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6bbf323-0bf0-4d7c-ba45-d010beed5190', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7EBC158C0>]}
[0m18:10:17.633538 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m18:10:17.804827 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m18:10:17.980979 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:10:17.981332 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:10:18.004247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6bbf323-0bf0-4d7c-ba45-d010beed5190', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7EC0ACC50>]}
[0m18:10:18.049984 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\manifest.json
[0m18:10:18.053758 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\semantic_manifest.json
[0m18:10:18.072917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6bbf323-0bf0-4d7c-ba45-d010beed5190', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7E8AEBA70>]}
[0m18:10:18.073465 [info ] [MainThread]: Found 2 models, 476 macros
[0m18:10:18.074148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6bbf323-0bf0-4d7c-ba45-d010beed5190', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7EBCBDD30>]}
[0m18:10:18.075534 [info ] [MainThread]: 
[0m18:10:18.076063 [info ] [MainThread]: Concurrency: 200 threads (target='dev')
[0m18:10:18.076399 [info ] [MainThread]: 
[0m18:10:18.077011 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:10:18.078239 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_expose_dev'
[0m18:10:18.165284 [debug] [ThreadPool]: Using snowflake connection "list_expose_dev"
[0m18:10:18.165618 [debug] [ThreadPool]: On list_expose_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "connection_name": "list_expose_dev"} */
show terse schemas in database expose_dev
    limit 10000
[0m18:10:18.165834 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:10:26.472916 [debug] [ThreadPool]: SQL status: SUCCESS 54 in 8.307 seconds
[0m18:10:26.483581 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_expose_dev_dpulse'
[0m18:10:26.491684 [debug] [ThreadPool]: Using snowflake connection "list_expose_dev_dpulse"
[0m18:10:26.492413 [debug] [ThreadPool]: On list_expose_dev_dpulse: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "connection_name": "list_expose_dev_dpulse"} */
alter session set quoted_identifiers_ignore_case = false;
[0m18:10:26.492729 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:10:26.847544 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.355 seconds
[0m18:10:26.854296 [debug] [ThreadPool]: Using snowflake connection "list_expose_dev_dpulse"
[0m18:10:26.854902 [debug] [ThreadPool]: On list_expose_dev_dpulse: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "connection_name": "list_expose_dev_dpulse"} */
show objects in expose_dev.dpulse
    limit 10000
    
;
[0m18:10:27.005748 [debug] [ThreadPool]: SQL status: SUCCESS 97 in 0.150 seconds
[0m18:10:27.011363 [debug] [ThreadPool]: Using snowflake connection "list_expose_dev_dpulse"
[0m18:10:27.011947 [debug] [ThreadPool]: On list_expose_dev_dpulse: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "connection_name": "list_expose_dev_dpulse"} */
alter session unset quoted_identifiers_ignore_case;
[0m18:10:27.086259 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.074 seconds
[0m18:10:27.097008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6bbf323-0bf0-4d7c-ba45-d010beed5190', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7EB6E7AD0>]}
[0m18:10:27.181740 [debug] [Thread-1 (]: Began running node model.GLOBAL_PERFMGT.crm_deal_quote_relevant
[0m18:10:27.182513 [info ] [Thread-1 (]: 1 of 1 START sql view model dpulse.crm_deal_quote_relevant ..................... [RUN]
[0m18:10:27.183231 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.GLOBAL_PERFMGT.crm_deal_quote_relevant'
[0m18:10:27.183488 [debug] [Thread-1 (]: Began compiling node model.GLOBAL_PERFMGT.crm_deal_quote_relevant
[0m18:10:27.188062 [debug] [Thread-1 (]: Writing injected SQL for node "model.GLOBAL_PERFMGT.crm_deal_quote_relevant"
[0m18:10:27.190106 [debug] [Thread-1 (]: Began executing node model.GLOBAL_PERFMGT.crm_deal_quote_relevant
[0m18:10:27.223071 [debug] [Thread-1 (]: Writing runtime sql for node "model.GLOBAL_PERFMGT.crm_deal_quote_relevant"
[0m18:10:27.228180 [debug] [Thread-1 (]: Using snowflake connection "model.GLOBAL_PERFMGT.crm_deal_quote_relevant"
[0m18:10:27.228904 [debug] [Thread-1 (]: On model.GLOBAL_PERFMGT.crm_deal_quote_relevant: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "node_id": "model.GLOBAL_PERFMGT.crm_deal_quote_relevant"} */
create or replace   view expose_dev.dpulse.crm_deal_quote_relevant
  
   as (
    

WITH LT_10 AS (
	SELECT 
		d.opportunityid, 
		d.id,
		q.quoteid,
		'10' fact_prog,
		q.name,
		q.createdon quote_createon,
		CASE WHEN MAX(q.createdon) OVER (PARTITION BY d.opportunityid) = q.createdon 
			THEN true 
			ELSE false 
		END filter,
		TO_CHAR(quote_createon,'YYYYMM') YM_START,
		NVL(TO_CHAR(datefinancialproposalagreed,'YYYYMM'),'999912') YM_END
		/*,progressiontech, datefinancialproposalagreed, datevalidated, datelegalagreement, d.createdon deal_createon, landlordsignaturedate, signaturedate,*/
	FROM finops.dwh.crm_deal d 
	LEFT JOIN finops.dwh.crm_quote q ON q.opportunityid = d.opportunityid
	WHERE --d.opportunityid='8602e810-0cb6-ee11-a569-000d3ab4b3e6' --'f1b05667-7d41-4bbc-9925-58e99d03ec9c' 
    --and 
    q.typecode ='809020000' --quote fin
    AND 
		(q.createdon< DATEADD(minute, 59, datefinancialproposalagreed ) 
		OR datefinancialproposalagreed IS NULL)
	QUALIFY filter = true
)
, LT_50 AS (
	SELECT 
		d.opportunityid, 
		d.id,
		q.quoteid,
		'50' fact_prog,
		q.name,
		q.createdon quote_createon,
		CASE WHEN min(q.createdon) OVER (PARTITION BY d.opportunityid) = q.createdon
			THEN true 
			ELSE false 
		END filter,
		TO_CHAR(quote_createon,'YYYYMM') YM_START,
		NVL(TO_CHAR(datevalidated,'YYYYMM'),'999912') YM_END
		/*,progressiontech, datefinancialproposalagreed, datevalidated, datelegalagreement, d.createdon deal_createon, landlordsignaturedate, signaturedate,*/
	FROM finops.dwh.crm_deal d 
	LEFT JOIN finops.dwh.crm_quote q ON q.opportunityid = d.opportunityid
	WHERE-- d.opportunityid='f1b05667-7d41-4bbc-9925-58e99d03ec9c'--'5b6b7053-7c73-4c7c-bd57-3fbf65bf46e9' AND
		(q.createdon< DATEADD(minute, 59, datevalidated)
		OR datevalidated IS NULL)
		AND progressiontech >= 50
		AND statereasoncode IN ('809020006','809020008') -- premiere quote valié
        and  q.typecode !='809020000' -- pas quote fin quote fin
	QUALIFY filter = true
)
, LT_70 AS (
	SELECT 
		d.opportunityid, 
		d.id,
		q.quoteid,
		'70' fact_prog,
		q.name,
		q.createdon quote_createon,
		CASE WHEN max(q.createdon) OVER (PARTITION BY d.opportunityid) = q.createdon 
			THEN true 
			ELSE false 
		END filter,
		TO_CHAR(quote_createon,'YYYYMM') YM_START,
		NVL(TO_CHAR(datelegalagreement,'YYYYMM'),'999912') YM_END
		/*,progressiontech, datefinancialproposalagreed, datevalidated, datelegalagreement, d.createdon deal_createon, landlordsignaturedate, signaturedate,*/
	FROM finops.dwh.crm_deal d 
	LEFT JOIN finops.dwh.crm_quote q ON q.opportunityid = d.opportunityid
	WHERE --d.opportunityid='f1b05667-7d41-4bbc-9925-58e99d03ec9c'--'5b6b7053-7c73-4c7c-bd57-3fbf65bf46e9' AND
		(q.createdon< DATEADD(minute, 59, datelegalagreement)
		OR datelegalagreement IS NULL)
		AND progressiontech >= 70
           and  q.typecode !='809020000' -- pas quote fin quote fin
	QUALIFY filter = true
)
, LT_90 AS (
	SELECT 
		d.opportunityid, 
		d.id,
		q.quoteid,
		'90' fact_prog,
		q.name,
		q.createdon quote_createon,
		CASE WHEN max(q.createdon) OVER (PARTITION BY d.opportunityid) = q.createdon 
			THEN true 
			ELSE false 
		END filter,
		TO_CHAR(quote_createon,'YYYYMM') YM_START,
		NVL(TO_CHAR(signaturedate,'YYYYMM'),'999912') YM_END
		/*,progressiontech, datefinancialproposalagreed, datevalidated, datelegalagreement, d.createdon deal_createon, landlordsignaturedate, signaturedate,*/
	FROM finops.dwh.crm_deal d 
	LEFT JOIN finops.dwh.crm_quote q ON q.opportunityid = d.opportunityid
	WHERE --d.opportunityid='11f976ee-4999-4f6c-beb9-12ee458a8df6'--'5b6b7053-7c73-4c7c-bd57-3fbf65bf46e9' AND 
		(q.createdon< DATEADD(minute, -1, signaturedate)
		OR signaturedate IS NULL)
		AND progressiontech >= 90
           and  q.typecode !='809020000' -- pas quote fin quote fin
	QUALIFY filter = true
)
, LT_100 AS (
	SELECT 
		d.opportunityid, 
		d.id,
		q.quoteid,
		'100' fact_prog,
		q.name,
		q.createdon quote_createon,
		true filter,
		TO_CHAR(quote_createon,'YYYYMM') YM_START,
		NVL(TO_CHAR(signaturedate,'YYYYMM'),'999912') YM_END
		/*,progressiontech, datefinancialproposalagreed, datevalidated, datelegalagreement, d.createdon deal_createon, landlordsignaturedate, signaturedate,*/
	FROM finops.dwh.crm_deal d 
	 left JOIN finops.dwh.crm_quote q ON q.opportunityid = d.opportunityid AND 
    d.quoteid = q.quoteid
	WHERE --d.opportunityid='6d4a9d80-bd0b-ef11-9f89-000d3abaebc4' AND
		progressiontech = 100
)
SELECT * exclude(filter)
FROM
(
	SELECT * FROM LT_10
	UNION ALL
	SELECT * FROM LT_50
	UNION ALL
	SELECT * FROM LT_70
	UNION ALL
	SELECT * FROM LT_90
	UNION ALL
	SELECT * FROM LT_100)
  );
[0m18:10:27.229556 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:10:28.133088 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.903 seconds
[0m18:10:28.169447 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6bbf323-0bf0-4d7c-ba45-d010beed5190', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7EC985FD0>]}
[0m18:10:28.170289 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dpulse.crm_deal_quote_relevant ................ [[32mSUCCESS 1[0m in 0.98s]
[0m18:10:28.171807 [debug] [Thread-1 (]: Finished running node model.GLOBAL_PERFMGT.crm_deal_quote_relevant
[0m18:10:28.188763 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:10:28.189334 [debug] [MainThread]: Connection 'list_expose_dev' was left open.
[0m18:10:28.189711 [debug] [MainThread]: On list_expose_dev: Close
[0m18:10:28.318988 [debug] [MainThread]: Connection 'list_expose_dev_dpulse' was left open.
[0m18:10:28.320155 [debug] [MainThread]: On list_expose_dev_dpulse: Close
[0m18:10:28.422798 [debug] [MainThread]: Connection 'model.GLOBAL_PERFMGT.crm_deal_quote_relevant' was left open.
[0m18:10:28.423888 [debug] [MainThread]: On model.GLOBAL_PERFMGT.crm_deal_quote_relevant: Close
[0m18:10:28.500651 [info ] [MainThread]: 
[0m18:10:28.502602 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.42 seconds (10.42s).
[0m18:10:28.504511 [debug] [MainThread]: Command end result
[0m18:10:28.549570 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\manifest.json
[0m18:10:28.553496 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\semantic_manifest.json
[0m18:10:28.562922 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\run_results.json
[0m18:10:28.563631 [info ] [MainThread]: 
[0m18:10:28.564341 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:10:28.564747 [info ] [MainThread]: 
[0m18:10:28.565300 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:10:28.566582 [debug] [MainThread]: Command `dbt run` succeeded at 18:10:28.566399 after 11.70 seconds
[0m18:10:28.567071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7EC7F78B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7EC12EF30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7EC12E7B0>]}
[0m18:10:28.567494 [debug] [MainThread]: Flushing usage events
[0m18:10:28.936728 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:11:35.248507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EA6433770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EA7136490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EA765FD90>]}


============================== 18:11:35.252118 | 5f7ea1f1-d2b1-4781-8cb8-d6d6759cadc4 ==============================
[0m18:11:35.252118 [info ] [MainThread]: Running with dbt=1.10.1
[0m18:11:35.253168 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alban.homo\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\alban.homo\\dev\\dperfmgt\\global_perfmgt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:11:35.594739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f7ea1f1-d2b1-4781-8cb8-d6d6759cadc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EA6B3EFD0>]}
[0m18:11:35.634597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f7ea1f1-d2b1-4781-8cb8-d6d6759cadc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EA95D58C0>]}
[0m18:11:35.635678 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m18:11:35.818442 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m18:11:35.988317 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:11:35.988683 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:11:36.005640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f7ea1f1-d2b1-4781-8cb8-d6d6759cadc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EA9585D50>]}
[0m18:11:36.061750 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\manifest.json
[0m18:11:36.065838 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\semantic_manifest.json
[0m18:11:36.084532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f7ea1f1-d2b1-4781-8cb8-d6d6759cadc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EA643BA70>]}
[0m18:11:36.084959 [info ] [MainThread]: Found 2 models, 476 macros
[0m18:11:36.085650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f7ea1f1-d2b1-4781-8cb8-d6d6759cadc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EA967C9F0>]}
[0m18:11:36.086900 [info ] [MainThread]: 
[0m18:11:36.087309 [info ] [MainThread]: Concurrency: 200 threads (target='dev')
[0m18:11:36.087776 [info ] [MainThread]: 
[0m18:11:36.088329 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:11:36.091733 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_expose_dev'
[0m18:11:36.176160 [debug] [ThreadPool]: Using snowflake connection "list_expose_dev"
[0m18:11:36.176725 [debug] [ThreadPool]: On list_expose_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "connection_name": "list_expose_dev"} */
show terse schemas in database expose_dev
    limit 10000
[0m18:11:36.177098 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:11:36.731268 [debug] [ThreadPool]: SQL status: SUCCESS 54 in 0.554 seconds
[0m18:11:36.734538 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_expose_dev_dpulse'
[0m18:11:36.741898 [debug] [ThreadPool]: Using snowflake connection "list_expose_dev_dpulse"
[0m18:11:36.742188 [debug] [ThreadPool]: On list_expose_dev_dpulse: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "connection_name": "list_expose_dev_dpulse"} */
alter session set quoted_identifiers_ignore_case = false;
[0m18:11:36.742391 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:11:37.058229 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.316 seconds
[0m18:11:37.065730 [debug] [ThreadPool]: Using snowflake connection "list_expose_dev_dpulse"
[0m18:11:37.066960 [debug] [ThreadPool]: On list_expose_dev_dpulse: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "connection_name": "list_expose_dev_dpulse"} */
show objects in expose_dev.dpulse
    limit 10000
    
;
[0m18:11:37.199616 [debug] [ThreadPool]: SQL status: SUCCESS 97 in 0.132 seconds
[0m18:11:37.208137 [debug] [ThreadPool]: Using snowflake connection "list_expose_dev_dpulse"
[0m18:11:37.209655 [debug] [ThreadPool]: On list_expose_dev_dpulse: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "connection_name": "list_expose_dev_dpulse"} */
alter session unset quoted_identifiers_ignore_case;
[0m18:11:37.445395 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.235 seconds
[0m18:11:37.460315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f7ea1f1-d2b1-4781-8cb8-d6d6759cadc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EA9F93AD0>]}
[0m18:11:37.515637 [debug] [Thread-1 (]: Began running node model.GLOBAL_PERFMGT.V_FACT_CONTRACT_PRODUCT_RENT_ROLL_FOR_VACANCY
[0m18:11:37.516067 [debug] [Thread-2 (]: Began running node model.GLOBAL_PERFMGT.crm_deal_quote_relevant
[0m18:11:37.516525 [info ] [Thread-1 (]: 1 of 2 START sql view model dpulse.V_FACT_CONTRACT_PRODUCT_RENT_ROLL_FOR_VACANCY  [RUN]
[0m18:11:37.517412 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.GLOBAL_PERFMGT.V_FACT_CONTRACT_PRODUCT_RENT_ROLL_FOR_VACANCY'
[0m18:11:37.517675 [debug] [Thread-1 (]: Began compiling node model.GLOBAL_PERFMGT.V_FACT_CONTRACT_PRODUCT_RENT_ROLL_FOR_VACANCY
[0m18:11:37.516955 [info ] [Thread-2 (]: 2 of 2 START sql view model dpulse.crm_deal_quote_relevant ..................... [RUN]
[0m18:11:37.522283 [debug] [Thread-1 (]: Writing injected SQL for node "model.GLOBAL_PERFMGT.V_FACT_CONTRACT_PRODUCT_RENT_ROLL_FOR_VACANCY"
[0m18:11:37.522767 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.GLOBAL_PERFMGT.crm_deal_quote_relevant'
[0m18:11:37.523214 [debug] [Thread-2 (]: Began compiling node model.GLOBAL_PERFMGT.crm_deal_quote_relevant
[0m18:11:37.525292 [debug] [Thread-2 (]: Writing injected SQL for node "model.GLOBAL_PERFMGT.crm_deal_quote_relevant"
[0m18:11:37.526500 [debug] [Thread-1 (]: Began executing node model.GLOBAL_PERFMGT.V_FACT_CONTRACT_PRODUCT_RENT_ROLL_FOR_VACANCY
[0m18:11:37.536762 [debug] [Thread-2 (]: Began executing node model.GLOBAL_PERFMGT.crm_deal_quote_relevant
[0m18:11:37.576780 [debug] [Thread-1 (]: Writing runtime sql for node "model.GLOBAL_PERFMGT.V_FACT_CONTRACT_PRODUCT_RENT_ROLL_FOR_VACANCY"
[0m18:11:37.579525 [debug] [Thread-2 (]: Writing runtime sql for node "model.GLOBAL_PERFMGT.crm_deal_quote_relevant"
[0m18:11:37.585764 [debug] [Thread-1 (]: Using snowflake connection "model.GLOBAL_PERFMGT.V_FACT_CONTRACT_PRODUCT_RENT_ROLL_FOR_VACANCY"
[0m18:11:37.590660 [debug] [Thread-2 (]: Using snowflake connection "model.GLOBAL_PERFMGT.crm_deal_quote_relevant"
[0m18:11:37.591845 [debug] [Thread-1 (]: On model.GLOBAL_PERFMGT.V_FACT_CONTRACT_PRODUCT_RENT_ROLL_FOR_VACANCY: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "node_id": "model.GLOBAL_PERFMGT.V_FACT_CONTRACT_PRODUCT_RENT_ROLL_FOR_VACANCY"} */
create or replace   view expose_dev.dpulse.V_FACT_CONTRACT_PRODUCT_RENT_ROLL_FOR_VACANCY
  
   as (
    

select 
 PC_ID,
 PRODUCT_EXT_REF,
 CONTRACT_ID,
BU_EXTREF ,
    case  when  SCENARIOS_RR like 'CLOSING4_%'
       then '01/01/'||year(current_date) 
     else    '01/01/'||year(dateadd(year,1,current_date)) end YM_START ,
    case  when  SCENARIOS_RR like 'CLOSING4_%'
       then '31/12/'||year(current_date) 
     else   '31/12/'||year(dateadd(year,1,current_date)) end   YM_END ,
         currency, 
        indicator_name KPI_TYPE, 
        --indicator_denum,
        indicator_num  KPI_AMOUNT,
        'CONTRACT_PRODUCT' FACT_TYPE 
--*  exclude (key_r,deleted,timestamp) 
from EXPOSE_DEV.DPERFMGT.V_DIM_RENT_ROLL_FOR_VACANCY dim 
join (
    select  key_r, 
        currency, 
        indicator_name, 
        indicator_denum,
        indicator_num
from EXPOSE.DPERFMGT.PLANIT_OPERATION_CUBE_RENT_ROLL_FOR_VACANCY_W_CURRENCY_AGG
union all
select key_r, 
        null currency, 
        indicator_name, 
        indicator_denum,
        indicator_num 
from EXPOSE.DPERFMGT.PLANIT_OPERATION_CUBE_RENT_ROLL_FOR_VACANCY_Wo_CURRENCY_AGG
) kpi on kpi.key_r=dim.key_r
 where 
 dim.status =  'Occupied'
--where --cscenario='FORECAST2' and  --cpropc='FR-SC-150' 

--cutoffcalmonth='202506'
--and clease='F106/11000186_SC'
  );
[0m18:11:37.593405 [debug] [Thread-2 (]: On model.GLOBAL_PERFMGT.crm_deal_quote_relevant: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "node_id": "model.GLOBAL_PERFMGT.crm_deal_quote_relevant"} */
create or replace   view expose_dev.dpulse.crm_deal_quote_relevant
  
   as (
    

WITH LT_10 AS (
	SELECT 
		d.opportunityid, 
		d.id,
		q.quoteid,
		'10' fact_prog,
		q.name,
		q.createdon quote_createon,
		CASE WHEN MAX(q.createdon) OVER (PARTITION BY d.opportunityid) = q.createdon 
			THEN true 
			ELSE false 
		END filter,
		TO_CHAR(quote_createon,'YYYYMM') YM_START,
		NVL(TO_CHAR(datefinancialproposalagreed,'YYYYMM'),'999912') YM_END
		/*,progressiontech, datefinancialproposalagreed, datevalidated, datelegalagreement, d.createdon deal_createon, landlordsignaturedate, signaturedate,*/
	FROM finops.dwh.crm_deal d 
	LEFT JOIN finops.dwh.crm_quote q ON q.opportunityid = d.opportunityid
	WHERE --d.opportunityid='8602e810-0cb6-ee11-a569-000d3ab4b3e6' --'f1b05667-7d41-4bbc-9925-58e99d03ec9c' 
    --and 
    q.typecode ='809020000' --quote fin
    AND 
		(q.createdon< DATEADD(minute, 59, datefinancialproposalagreed ) 
		OR datefinancialproposalagreed IS NULL)
	QUALIFY filter = true
)
, LT_50 AS (
	SELECT 
		d.opportunityid, 
		d.id,
		q.quoteid,
		'50' fact_prog,
		q.name,
		q.createdon quote_createon,
		CASE WHEN min(q.createdon) OVER (PARTITION BY d.opportunityid) = q.createdon
			THEN true 
			ELSE false 
		END filter,
		TO_CHAR(quote_createon,'YYYYMM') YM_START,
		NVL(TO_CHAR(datevalidated,'YYYYMM'),'999912') YM_END
		/*,progressiontech, datefinancialproposalagreed, datevalidated, datelegalagreement, d.createdon deal_createon, landlordsignaturedate, signaturedate,*/
	FROM finops.dwh.crm_deal d 
	LEFT JOIN finops.dwh.crm_quote q ON q.opportunityid = d.opportunityid
	WHERE-- d.opportunityid='f1b05667-7d41-4bbc-9925-58e99d03ec9c'--'5b6b7053-7c73-4c7c-bd57-3fbf65bf46e9' AND
		(q.createdon< DATEADD(minute, 59, datevalidated)
		OR datevalidated IS NULL)
		AND progressiontech >= 50
		AND statereasoncode IN ('809020006','809020008') -- premiere quote valié
        and  q.typecode !='809020000' -- pas quote fin quote fin
	QUALIFY filter = true
)
, LT_70 AS (
	SELECT 
		d.opportunityid, 
		d.id,
		q.quoteid,
		'70' fact_prog,
		q.name,
		q.createdon quote_createon,
		CASE WHEN max(q.createdon) OVER (PARTITION BY d.opportunityid) = q.createdon 
			THEN true 
			ELSE false 
		END filter,
		TO_CHAR(quote_createon,'YYYYMM') YM_START,
		NVL(TO_CHAR(datelegalagreement,'YYYYMM'),'999912') YM_END
		/*,progressiontech, datefinancialproposalagreed, datevalidated, datelegalagreement, d.createdon deal_createon, landlordsignaturedate, signaturedate,*/
	FROM finops.dwh.crm_deal d 
	LEFT JOIN finops.dwh.crm_quote q ON q.opportunityid = d.opportunityid
	WHERE --d.opportunityid='f1b05667-7d41-4bbc-9925-58e99d03ec9c'--'5b6b7053-7c73-4c7c-bd57-3fbf65bf46e9' AND
		(q.createdon< DATEADD(minute, 59, datelegalagreement)
		OR datelegalagreement IS NULL)
		AND progressiontech >= 70
           and  q.typecode !='809020000' -- pas quote fin quote fin
	QUALIFY filter = true
)
, LT_90 AS (
	SELECT 
		d.opportunityid, 
		d.id,
		q.quoteid,
		'90' fact_prog,
		q.name,
		q.createdon quote_createon,
		CASE WHEN max(q.createdon) OVER (PARTITION BY d.opportunityid) = q.createdon 
			THEN true 
			ELSE false 
		END filter,
		TO_CHAR(quote_createon,'YYYYMM') YM_START,
		NVL(TO_CHAR(signaturedate,'YYYYMM'),'999912') YM_END
		/*,progressiontech, datefinancialproposalagreed, datevalidated, datelegalagreement, d.createdon deal_createon, landlordsignaturedate, signaturedate,*/
	FROM finops.dwh.crm_deal d 
	LEFT JOIN finops.dwh.crm_quote q ON q.opportunityid = d.opportunityid
	WHERE --d.opportunityid='11f976ee-4999-4f6c-beb9-12ee458a8df6'--'5b6b7053-7c73-4c7c-bd57-3fbf65bf46e9' AND 
		(q.createdon< DATEADD(minute, -1, signaturedate)
		OR signaturedate IS NULL)
		AND progressiontech >= 90
           and  q.typecode !='809020000' -- pas quote fin quote fin
	QUALIFY filter = true
)
, LT_100 AS (
	SELECT 
		d.opportunityid, 
		d.id,
		q.quoteid,
		'100' fact_prog,
		q.name,
		q.createdon quote_createon,
		true filter,
		TO_CHAR(quote_createon,'YYYYMM') YM_START,
		NVL(TO_CHAR(signaturedate,'YYYYMM'),'999912') YM_END
		/*,progressiontech, datefinancialproposalagreed, datevalidated, datelegalagreement, d.createdon deal_createon, landlordsignaturedate, signaturedate,*/
	FROM finops.dwh.crm_deal d 
	 left JOIN finops.dwh.crm_quote q ON q.opportunityid = d.opportunityid AND 
    d.quoteid = q.quoteid
	WHERE --d.opportunityid='6d4a9d80-bd0b-ef11-9f89-000d3abaebc4' AND
		progressiontech = 100
)
SELECT * exclude(filter)
FROM
(
	SELECT * FROM LT_10
	UNION ALL
	SELECT * FROM LT_50
	UNION ALL
	SELECT * FROM LT_70
	UNION ALL
	SELECT * FROM LT_90
	UNION ALL
	SELECT * FROM LT_100)
  );
[0m18:11:37.594811 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:11:37.595777 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:11:38.473406 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.879 seconds
[0m18:11:38.493010 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f7ea1f1-d2b1-4781-8cb8-d6d6759cadc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EAA27E450>]}
[0m18:11:38.493666 [info ] [Thread-1 (]: 1 of 2 OK created sql view model dpulse.V_FACT_CONTRACT_PRODUCT_RENT_ROLL_FOR_VACANCY  [[32mSUCCESS 1[0m in 0.97s]
[0m18:11:38.494583 [debug] [Thread-1 (]: Finished running node model.GLOBAL_PERFMGT.V_FACT_CONTRACT_PRODUCT_RENT_ROLL_FOR_VACANCY
[0m18:11:38.730052 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.134 seconds
[0m18:11:38.733505 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f7ea1f1-d2b1-4781-8cb8-d6d6759cadc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EAA11FB70>]}
[0m18:11:38.734001 [info ] [Thread-2 (]: 2 of 2 OK created sql view model dpulse.crm_deal_quote_relevant ................ [[32mSUCCESS 1[0m in 1.21s]
[0m18:11:38.735155 [debug] [Thread-2 (]: Finished running node model.GLOBAL_PERFMGT.crm_deal_quote_relevant
[0m18:11:38.747406 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:11:38.748536 [debug] [MainThread]: Connection 'list_expose_dev' was left open.
[0m18:11:38.748807 [debug] [MainThread]: On list_expose_dev: Close
[0m18:11:38.823552 [debug] [MainThread]: Connection 'list_expose_dev_dpulse' was left open.
[0m18:11:38.824454 [debug] [MainThread]: On list_expose_dev_dpulse: Close
[0m18:11:38.897912 [debug] [MainThread]: Connection 'model.GLOBAL_PERFMGT.V_FACT_CONTRACT_PRODUCT_RENT_ROLL_FOR_VACANCY' was left open.
[0m18:11:38.898778 [debug] [MainThread]: On model.GLOBAL_PERFMGT.V_FACT_CONTRACT_PRODUCT_RENT_ROLL_FOR_VACANCY: Close
[0m18:11:39.151523 [debug] [MainThread]: Connection 'model.GLOBAL_PERFMGT.crm_deal_quote_relevant' was left open.
[0m18:11:39.152318 [debug] [MainThread]: On model.GLOBAL_PERFMGT.crm_deal_quote_relevant: Close
[0m18:11:39.232825 [info ] [MainThread]: 
[0m18:11:39.234222 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 3.14 seconds (3.14s).
[0m18:11:39.236459 [debug] [MainThread]: Command end result
[0m18:11:39.258495 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\manifest.json
[0m18:11:39.261680 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\semantic_manifest.json
[0m18:11:39.267353 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\run_results.json
[0m18:11:39.267671 [info ] [MainThread]: 
[0m18:11:39.268353 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:11:39.268891 [info ] [MainThread]: 
[0m18:11:39.269352 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m18:11:39.270103 [debug] [MainThread]: Command `dbt run` succeeded at 18:11:39.270008 after 4.28 seconds
[0m18:11:39.270382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EAA1F36B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EAA118680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EA9E80AD0>]}
[0m18:11:39.270693 [debug] [MainThread]: Flushing usage events
[0m18:11:39.579934 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:29:36.701778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9A1303770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9A2016490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9A253FD90>]}


============================== 18:29:36.708974 | d2527728-a4c9-4a57-9c64-99611ddd244e ==============================
[0m18:29:36.708974 [info ] [MainThread]: Running with dbt=1.10.1
[0m18:29:36.710095 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alban.homo\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\alban.homo\\dev\\dperfmgt\\global_perfmgt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:29:37.085153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2527728-a4c9-4a57-9c64-99611ddd244e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9A1A1EFD0>]}
[0m18:29:37.126295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd2527728-a4c9-4a57-9c64-99611ddd244e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9A44258C0>]}
[0m18:29:37.127357 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m18:29:37.331759 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m18:29:37.447610 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m18:29:37.448354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd2527728-a4c9-4a57-9c64-99611ddd244e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9A43D6450>]}
[0m18:29:38.033532 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'CRM_DEAL_QUOTE_RELEVANT' in the 'models' section of file 'models\DPERFMGT\schema.yml'
[0m18:29:38.097569 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'CRM_DEAL_QUOTE_RELEVANT' in the 'models' section of file 'models\DPULSE\schema.yml'
[0m18:29:38.098723 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two schema.yml entries for the same resource named V_FACT_CONTRACT_PRODUCT_RENT_ROLL_FOR_VACANCY. Resources and their associated columns may only be described a single time. To fix this, remove the resource entry for V_FACT_CONTRACT_PRODUCT_RENT_ROLL_FOR_VACANCY in one of these files:
   - models\DPULSE\schema.yml
  models\DPERFMGT\schema.yml
[0m18:29:38.099987 [debug] [MainThread]: Command `dbt run` failed at 18:29:38.099881 after 1.72 seconds
[0m18:29:38.100272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9A4AB0230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9A4AB0320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9A244BE70>]}
[0m18:29:38.100650 [debug] [MainThread]: Flushing usage events
[0m18:29:38.453065 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:30:36.820536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A19FEE3770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1A0BF6490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1A111FD90>]}


============================== 18:30:36.826601 | f3db0805-555f-4373-9ce3-ae10c32e7ab5 ==============================
[0m18:30:36.826601 [info ] [MainThread]: Running with dbt=1.10.1
[0m18:30:36.827526 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alban.homo\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\alban.homo\\dev\\dperfmgt\\global_perfmgt\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:30:37.232217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3db0805-555f-4373-9ce3-ae10c32e7ab5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1A05FAFD0>]}
[0m18:30:37.279375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f3db0805-555f-4373-9ce3-ae10c32e7ab5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1A2FF58C0>]}
[0m18:30:37.280432 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m18:30:37.472566 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m18:30:37.606438 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m18:30:37.607153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f3db0805-555f-4373-9ce3-ae10c32e7ab5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1A2FA6450>]}
[0m18:30:38.409898 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'CRM_DEAL_QUOTE_RELEVANT' in the 'models' section of file 'models\DPULSE\schema.yml'
[0m18:30:38.474003 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.GLOBAL_PERFMGT.unique_CRM_DEAL_QUOTE_RELEVANT_opportunityid.cb346feb1b' (models\DPULSE\schema.yml) depends on a node named 'CRM_DEAL_QUOTE_RELEVANT' in package '' which was not found
[0m18:30:38.475890 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.GLOBAL_PERFMGT.not_null_CRM_DEAL_QUOTE_RELEVANT_opportunityid.98ccdb2521' (models\DPULSE\schema.yml) depends on a node named 'CRM_DEAL_QUOTE_RELEVANT' in package '' which was not found
[0m18:30:38.538027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3db0805-555f-4373-9ce3-ae10c32e7ab5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1A333A990>]}
[0m18:30:38.592522 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\manifest.json
[0m18:30:38.597303 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alban.homo\dev\dperfmgt\global_perfmgt\target\semantic_manifest.json
[0m18:30:38.618709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f3db0805-555f-4373-9ce3-ae10c32e7ab5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1A37482F0>]}
[0m18:30:38.619190 [info ] [MainThread]: Found 2 models, 477 macros
[0m18:30:38.619728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3db0805-555f-4373-9ce3-ae10c32e7ab5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1A37235F0>]}
[0m18:30:38.621063 [info ] [MainThread]: 
[0m18:30:38.621551 [info ] [MainThread]: Concurrency: 200 threads (target='dev')
[0m18:30:38.621959 [info ] [MainThread]: 
[0m18:30:38.622626 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:30:38.627683 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_expose_dev'
[0m18:30:38.636874 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_expose_dev'
[0m18:30:38.747295 [debug] [ThreadPool]: Using snowflake connection "list_expose_dev"
[0m18:30:38.747730 [debug] [ThreadPool]: Using snowflake connection "list_expose_dev"
[0m18:30:38.748035 [debug] [ThreadPool]: On list_expose_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "connection_name": "list_expose_dev"} */
show terse schemas in database expose_dev
    limit 10000
[0m18:30:38.748294 [debug] [ThreadPool]: On list_expose_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "connection_name": "list_expose_dev"} */
show terse schemas in database expose_dev
    limit 10000
[0m18:30:38.748524 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:30:38.748734 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:30:39.249717 [debug] [ThreadPool]: SQL status: SUCCESS 54 in 0.501 seconds
[0m18:30:39.276373 [debug] [ThreadPool]: SQL status: SUCCESS 54 in 0.528 seconds
[0m18:30:39.281405 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_expose_dev, now create_expose_dev_dpulse_DPULSE)
[0m18:30:39.281864 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_expose_dev, now create_expose_dev_dpulse_DPERFMGT)
[0m18:30:39.284562 [debug] [ThreadPool]: Creating schema "database: "expose_dev"
schema: "dpulse_DPULSE"
"
[0m18:30:39.285229 [debug] [ThreadPool]: Creating schema "database: "expose_dev"
schema: "dpulse_DPERFMGT"
"
[0m18:30:39.290902 [debug] [ThreadPool]: Using snowflake connection "create_expose_dev_dpulse_DPULSE"
[0m18:30:39.293744 [debug] [ThreadPool]: Using snowflake connection "create_expose_dev_dpulse_DPERFMGT"
[0m18:30:39.294365 [debug] [ThreadPool]: On create_expose_dev_dpulse_DPULSE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "connection_name": "create_expose_dev_dpulse_DPULSE"} */
create schema if not exists expose_dev.dpulse_DPULSE
[0m18:30:39.294897 [debug] [ThreadPool]: On create_expose_dev_dpulse_DPERFMGT: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "connection_name": "create_expose_dev_dpulse_DPERFMGT"} */
create schema if not exists expose_dev.dpulse_DPERFMGT
[0m18:30:39.401072 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bd17de-0106-9f59-0000-03a97f91c812
[0m18:30:39.402209 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bd17de-0106-9eb9-0000-03a97f91ba16
[0m18:30:39.402709 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 003001 (42501): Erreur de contrôle d'accès SQL :
privilèges insuffisants pour effectuer des opérations sur database « EXPOSE_DEV »
[0m18:30:39.403111 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 003001 (42501): Erreur de contrôle d'accès SQL :
privilèges insuffisants pour effectuer des opérations sur database « EXPOSE_DEV »
[0m18:30:39.403542 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro create_schema
[0m18:30:39.404030 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro create_schema
[0m18:30:39.404345 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m18:30:39.404659 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m18:30:39.406028 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:30:39.406587 [debug] [MainThread]: Connection 'create_expose_dev_dpulse_DPULSE' was left open.
[0m18:30:39.406996 [debug] [MainThread]: On create_expose_dev_dpulse_DPULSE: Close
[0m18:30:39.505124 [debug] [MainThread]: Connection 'create_expose_dev_dpulse_DPERFMGT' was left open.
[0m18:30:39.505898 [debug] [MainThread]: On create_expose_dev_dpulse_DPERFMGT: Close
[0m18:30:39.598569 [info ] [MainThread]: 
[0m18:30:39.599299 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.98 seconds (0.98s).
[0m18:30:39.599877 [error] [MainThread]: Encountered an error:
Database Error
  003001 (42501): Erreur de contrôle d'accès SQL :
  privilèges insuffisants pour effectuer des opérations sur database « EXPOSE_DEV »
[0m18:30:39.600608 [debug] [MainThread]: Command `dbt run` failed at 18:30:39.600510 after 3.12 seconds
[0m18:30:39.600901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1A0E53F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1A3544CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1A3CE1A70>]}
[0m18:30:39.601178 [debug] [MainThread]: Flushing usage events
[0m18:30:39.924349 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:02:40.429256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BC7EEF620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BC8BEE490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BC9117ED0>]}


============================== 09:02:40.435620 | 8467c428-f428-4d7f-9f64-779a427a88bd ==============================
[0m09:02:40.435620 [info ] [MainThread]: Running with dbt=1.10.1
[0m09:02:40.436573 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alban.homo\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\alban.homo\\dev\\dperfmgt\\GLOBAL_PERFMGT\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:02:40.594496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8467c428-f428-4d7f-9f64-779a427a88bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BC85EAD70>]}
[0m09:02:40.630858 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m09:02:40.633914 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m09:02:40.636060 [debug] [MainThread]: Command `cli deps` succeeded at 09:02:40.634956 after 0.55 seconds
[0m09:02:40.636966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BC9029F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BC9028F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BC9006050>]}
[0m09:02:40.637965 [debug] [MainThread]: Flushing usage events
[0m09:02:40.977948 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:42:00.866903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171F7903620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171F85FE490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171F8B27ED0>]}


============================== 13:42:00.873982 | 92f4a146-1e3f-423a-a79a-76a4a51f4d5f ==============================
[0m13:42:00.873982 [info ] [MainThread]: Running with dbt=1.10.1
[0m13:42:00.874998 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alban.homo\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'c:\\Users\\alban.homo\\dev\\dperfmgt\\GLOBAL_PERFMGT\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:42:00.977631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '92f4a146-1e3f-423a-a79a-76a4a51f4d5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171F7FFAD70>]}
[0m13:42:01.000324 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:42:01.002187 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:42:01.002988 [debug] [MainThread]: Command `cli deps` succeeded at 13:42:01.002880 after 0.39 seconds
[0m13:42:01.003460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171F8A39F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171F8A38F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171F8A15C50>]}
[0m13:42:01.003781 [debug] [MainThread]: Flushing usage events
[0m13:42:01.382637 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:18:04.589285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013234253620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013234F3E490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013235467ED0>]}


============================== 14:18:04.594827 | 8c89c515-8434-40e6-a14d-03f571960d19 ==============================
[0m14:18:04.594827 [info ] [MainThread]: Running with dbt=1.10.1
[0m14:18:04.595358 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\alban.homo\\.dbt', 'log_path': 'c:\\Users\\alban.homo\\dev\\DPERFMGT\\GLOBAL_PERFMGT\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt ', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:18:04.746996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c89c515-8434-40e6-a14d-03f571960d19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013234946D70>]}
[0m14:18:04.776968 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:18:04.781602 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:18:04.784112 [debug] [MainThread]: Command `cli deps` succeeded at 14:18:04.783639 after 0.51 seconds
[0m14:18:04.784836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013235379F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013235378F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013235355C50>]}
[0m14:18:04.785573 [debug] [MainThread]: Flushing usage events
[0m14:18:05.103248 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:29:48.959090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211CD9E7620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211CE6F6490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211CEC1FD90>]}


============================== 16:29:48.964800 | 7de776cc-cecf-48ae-a434-7e55d49e93f4 ==============================
[0m16:29:48.964800 [info ] [MainThread]: Running with dbt=1.10.1
[0m16:29:48.965739 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\alban.homo\\dev\\snfk-dbt\\snfk-dbt\\logs', 'profiles_dir': 'C:\\Users\\alban.homo\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select crm_deal_quote_relevant', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:29:49.362754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7de776cc-cecf-48ae-a434-7e55d49e93f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211CE0FEFD0>]}
[0m16:29:49.405096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7de776cc-cecf-48ae-a434-7e55d49e93f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211D0AC58C0>]}
[0m16:29:49.406451 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m16:29:49.609425 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m16:29:49.767731 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:29:49.768090 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:29:49.791420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7de776cc-cecf-48ae-a434-7e55d49e93f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211D0F5CB50>]}
[0m16:29:49.837102 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alban.homo\dev\snfk-dbt\snfk-dbt\target\manifest.json
[0m16:29:49.841239 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alban.homo\dev\snfk-dbt\snfk-dbt\target\semantic_manifest.json
[0m16:29:49.861487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7de776cc-cecf-48ae-a434-7e55d49e93f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211CD9EBA70>]}
[0m16:29:49.861902 [info ] [MainThread]: Found 2 models, 477 macros
[0m16:29:49.862294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7de776cc-cecf-48ae-a434-7e55d49e93f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211D0B6DFD0>]}
[0m16:29:49.863394 [info ] [MainThread]: 
[0m16:29:49.863981 [info ] [MainThread]: Concurrency: 200 threads (target='dev')
[0m16:29:49.864512 [info ] [MainThread]: 
[0m16:29:49.865068 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:29:49.866258 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EXPOSE_DEV'
[0m16:29:49.955523 [debug] [ThreadPool]: Using snowflake connection "list_EXPOSE_DEV"
[0m16:29:49.955837 [debug] [ThreadPool]: On list_EXPOSE_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "connection_name": "list_EXPOSE_DEV"} */
show terse schemas in database EXPOSE_DEV
    limit 10000
[0m16:29:49.956039 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:29:55.694011 [debug] [ThreadPool]: SQL status: SUCCESS 54 in 5.738 seconds
[0m16:29:55.700023 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_EXPOSE_DEV, now create_EXPOSE_DEV_dpulse_DPULSE)
[0m16:29:55.701223 [debug] [ThreadPool]: Creating schema "database: "EXPOSE_DEV"
schema: "dpulse_DPULSE"
"
[0m16:29:55.707436 [debug] [ThreadPool]: Using snowflake connection "create_EXPOSE_DEV_dpulse_DPULSE"
[0m16:29:55.707834 [debug] [ThreadPool]: On create_EXPOSE_DEV_dpulse_DPULSE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "GLOBAL_PERFMGT", "target_name": "dev", "connection_name": "create_EXPOSE_DEV_dpulse_DPULSE"} */
create schema if not exists EXPOSE_DEV.dpulse_DPULSE
[0m16:29:55.869832 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bd1d05-0106-a02b-0000-03a97fbaacb6
[0m16:29:55.870440 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 003001 (42501): Erreur de contrôle d'accès SQL :
privilèges insuffisants pour effectuer des opérations sur database « EXPOSE_DEV »
[0m16:29:55.870990 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro create_schema
[0m16:29:55.871376 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m16:29:55.873986 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:29:55.874929 [debug] [MainThread]: Connection 'create_EXPOSE_DEV_dpulse_DPULSE' was left open.
[0m16:29:55.875810 [debug] [MainThread]: On create_EXPOSE_DEV_dpulse_DPULSE: Close
[0m16:29:55.955132 [info ] [MainThread]: 
[0m16:29:55.956564 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 6.09 seconds (6.09s).
[0m16:29:55.957910 [error] [MainThread]: Encountered an error:
Database Error
  003001 (42501): Erreur de contrôle d'accès SQL :
  privilèges insuffisants pour effectuer des opérations sur database « EXPOSE_DEV »
[0m16:29:55.960193 [debug] [MainThread]: Command `dbt run` failed at 16:29:55.959748 after 7.30 seconds
[0m16:29:55.961637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211D14761A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211CECC4410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211D16FD850>]}
[0m16:29:55.962552 [debug] [MainThread]: Flushing usage events
[0m16:29:56.288294 [debug] [MainThread]: An error was encountered while trying to flush usage events
