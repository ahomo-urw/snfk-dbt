create or replace view DPULSE.CRM_STEPRENT(
	DEDUCTIONAMOUNTCALC,
	ENDDATECALC,
	MONTHLYREDUCEDMGRM,
	MONTHLYREDUCEDMGRM2,
	NAME,
	PERCENTAGECALC,
	PERCOFREDUCTION,
	PERIOD,
	quote_id,
	QUOTEIDNAME,
	REDUCEDMGRAMOUNTCALC,
	REDUCTIONCODE,
	REDUCTIONCODENAME,
	STARTDATE,
	STEPRENTID,
	TYPECODE,
	TYPECODENAME,
	UNITCODE,
	UNITCODENAME,
	YEARLYMONTHLYREDUCEDMGRCODE,
	YEARLYMONTHLYREDUCEDMGRCODENAME,
	YEARLYREDUCEDMGR,
	YEARLYREDUCEDMGRCALC,
	STATECODE,
	STATECODENAME,
	STATUSCODE,
	STATUSCODENAME,
	transactioncurrency_id,
	TRANSACTIONCURRENCYIDNAME
) as 
select --ifnull(dealname,'')                  as deal_id  SGE_modif champs supp 
    -- , 
    DEDUCTIONAMOUNTCALC,
	ENDDATECALC,
	MONTHLYREDUCEDMGRM,
	MONTHLYREDUCEDMGRM2,
	NAME,
	PERCENTAGECALC,
	PERCOFREDUCTION,
	PERIOD,
     ifnull(quoteid,'')                   as quote_id,
	QUOTEIDNAME,
	REDUCEDMGRAMOUNTCALC,
	REDUCTIONCODE,
	REDUCTIONCODENAME,
	STARTDATE,
	STEPRENTID,
	TYPECODE,
	TYPECODENAME,
	UNITCODE,
	UNITCODENAME,
	YEARLYMONTHLYREDUCEDMGRCODE,
	YEARLYMONTHLYREDUCEDMGRCODENAME,
	YEARLYREDUCEDMGR,
	YEARLYREDUCEDMGRCALC,
	STATECODE,
	STATECODENAME,
	STATUSCODE,
	STATUSCODENAME,
    ifnull(transactioncurrencyid,'')     as transactioncurrency_id,
	TRANSACTIONCURRENCYIDNAME
from finops.dwh.crm_steprent;